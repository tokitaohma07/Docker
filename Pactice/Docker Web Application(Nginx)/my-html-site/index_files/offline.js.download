(function(g){var window=this;'use strict';var YtL=function(c){var I=new g.zH("und",new g.rR("Default","und",!0));I.captionTracks=c.captionTracks;return I},Lc7=function(c){return new g.Ap(function(I,O){var r=c.length,u=[];
if(r)for(var X=function(m,n){r--;u[m]=n;r==0&&I(u)},v=function(m){O(m)},M,G=0;G<c.length;G++)M=c[G],g.xBx(M,g.ze(X,G),v);
else I(u)})},$k=function(c){this.C=c},ak=function(){$k.apply(this,arguments)},p8k=function(){ak.apply(this,arguments)},UNt=function(){ak.apply(this,arguments)},CBk=function(){ak.apply(this,arguments)},tK$=function(){ak.apply(this,arguments)},H67=function(){ak.apply(this,arguments)},lPz=function(){ak.apply(this,arguments)},Tws=function(){$k.apply(this,arguments)},ETL=function(){ak.apply(this,arguments)},b6b=function(){ak.apply(this,arguments)},eUY=function(){ak.apply(this,arguments)},FcX=function(){ak.apply(this,
arguments)},$NL=function(){ak.apply(this,arguments)},aPu=function(){ak.apply(this,arguments)},oTL=function(){ak.apply(this,arguments)},kDs=function(){ak.apply(this,arguments)},Kct=function(){ak.apply(this,arguments)},Bwz=function(){ak.apply(this,arguments)},St$=function(){ak.apply(this,arguments)},gTz=function(){ak.apply(this,arguments)},fP$=function(){$k.apply(this,arguments)},qtX=function(){ak.apply(this,arguments)},w8z=function(){ak.apply(this,arguments)},dNt=function(){ak.apply(this,arguments)},
RUu=function(){ak.apply(this,arguments)},sTX=function(){ak.apply(this,arguments)},xN7=function(){ak.apply(this,arguments)},Z6L=function(){ak.apply(this,arguments)},zUt=function(){ak.apply(this,arguments)},QTt=function(){ak.apply(this,arguments)},cVL=function(){$k.apply(this,arguments)},I_k=function(){$k.apply(this,arguments)},OkY=function(){$k.apply(this,arguments)},rVk=function(){ak.apply(this,arguments)},u4X=function(){ak.apply(this,arguments)},XoX=function(){ak.apply(this,arguments)},vxa=function(){ak.apply(this,
arguments)},P9Y=function(){ak.apply(this,arguments)},M77=function(){ak.apply(this,arguments)},ikb=function(){ak.apply(this,arguments)},Gks=function(){ak.apply(this,arguments)},jbO=function(){ak.apply(this,arguments)},my$=function(){ak.apply(this,arguments)},nxs=function(){ak.apply(this,arguments)},hrO=function(){ak.apply(this,arguments)},V7k=function(){ak.apply(this,arguments)},AVX=function(){ak.apply(this,arguments)},NsX=function(){ak.apply(this,arguments)},Dyu=function(){ak.apply(this,arguments)},
WSz=function(){ak.apply(this,arguments)},yV7=function(){ak.apply(this,arguments)},JVk=function(){ak.apply(this,arguments)},YRk=function(){ak.apply(this,arguments)},LSs=function(){ak.apply(this,arguments)},pos=function(){ak.apply(this,arguments)},UyX=function(){ak.apply(this,arguments)},C9a=function(){ak.apply(this,arguments)},t7k=function(){ak.apply(this,arguments)},Hkz=function(){ak.apply(this,arguments)},l_b=function(){$k.apply(this,arguments)},Ts7=function(){ak.apply(this,arguments)},Exu=function(){ak.apply(this,
arguments)},bku=function(){ak.apply(this,arguments)},ers=function(){ak.apply(this,arguments)},FSO=function(){ak.apply(this,arguments)},$yk=function(){ak.apply(this,arguments)},a_L=function(){ak.apply(this,arguments)},oxt=function(){ak.apply(this,arguments)},kkk=function(){ak.apply(this,arguments)},KSs=function(){ak.apply(this,arguments)},Bs7=function(){ak.apply(this,arguments)},SR7=function(){ak.apply(this,arguments)},gx7=function(){ak.apply(this,arguments)},f_a=function(){ak.apply(this,arguments)},
qRL=function(){ak.apply(this,arguments)},woL=function(){ak.apply(this,arguments)},dys=function(){ak.apply(this,arguments)},Rru=function(){ak.apply(this,arguments)},sbL=function(){ak.apply(this,arguments)},xyz=function(){ak.apply(this,arguments)},ZkX=function(){ak.apply(this,arguments)},zrt=function(){ak.apply(this,arguments)},Qbk=function(){ak.apply(this,arguments)},cbb=function(){ak.apply(this,arguments)},INk=function(){ak.apply(this,arguments)},OgO=function(){ak.apply(this,arguments)},rbs=function(){ak.apply(this,
arguments)},u_7=function(){ak.apply(this,arguments)},Xhk=function(){ak.apply(this,arguments)},v5s=function(){ak.apply(this,arguments)},PmY=function(c){c=c.key||c.id;
if(!c)throw Error("Entity key is missing");return c},MHb=function(){if(ok)return ok();
var c={};ok=g.Ov("PersistentEntityStoreDb",{B_:(c.EntityStore={BO:1},c.EntityAssociationStore={BO:2},c),shared:!1,upgrade:function(I,O){O(1)&&g.oh(g.E2(I,"EntityStore",{keyPath:"key"}),"entityType","entityType");O(2)&&(I=g.E2(I,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.oh(I,"byParentEntityKey","parentEntityKey"),g.oh(I,"byChildEntityKey","childEntityKey"))},
version:3});return ok()},ig7=function(c){return g.w2(MHb(),c)},GGa=function(c){return g.w2((0,g.IzX)(),c)},kk=function(c){this.token=c},K$=function(c,I){I=I===void 0?{}:I;
g.sZ.call(this,g.OO7[c],Object.assign({},{name:"PESEncoderError",type:c},I));this.type=c;this.level="WARNING";Object.setPrototypeOf(this,K$.prototype)},jpu=function(c){return new K$("WRONG_DATA_TYPE",{sx:c})},mnt=function(c){return c instanceof Error?new K$("UNKNOWN_ENCODE_ERROR",{Ym:c.message}):new K$("UNKNOWN_ENCODE_ERROR")},n5L=function(c){return c instanceof Error?new K$("UNKNOWN_DECODE_ERROR",{Ym:c.message}):new K$("UNKNOWN_DECODE_ERROR")},h8$=function(c,I){c=c instanceof K$?c:I(c);
g.F8(c);throw c;},VHa=function(){},Abk=function(c,I,O){try{return c.W(I,O)}catch(r){h8$(r,mnt)}},NHz=function(c){c=(new TextEncoder).encode(c).subarray(0,16);
var I=new Uint8Array(16);I.set(c);return I},Bm=function(c){this.C=c},WvL=function(c){var I=Dn$[c];
if(I)return I;g.$S(new g.sZ("Entity model not found.",{entityType:c}))},ybk=function(c,I){this.C=c;
this.N=I;this.W={}},Yeu=function(c,I){a:{c=Jba(c.N,I.version);
try{var O=c.N(I.data,I.key);break a}catch(r){h8$(r,n5L)}O=void 0}return O},Si=function(c,I,O){return c.C.objectStore("EntityStore").get(I).then(function(r){if(r){if(O&&r.entityType!==O)throw Error("Incorrect entity type");
return Yeu(c,r)}})},g0=function(c,I,O){return O?(O=O.map(function(r){return Si(c,r,I)}),g.U2.all(O)):c.C.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(I)).then(function(r){return r.map(function(u){return Yeu(c,u)})})},qu=function(c,I,O){var r=PmY(I),u=Jba(c.N,1),X=Object.assign({},I);
return c.C.objectStore("EntityStore").get(r).then(function(v){if(v){if(v.entityType!==O)throw Error("Incorrect entity type");X.entityMetadata||(v=Yeu(c,v),X.entityMetadata=v.entityMetadata)}}).then(function(){var v={key:r,
entityType:O,data:Abk(u,X,r),version:1};return g.U2.all([g.FV(c.C.objectStore("EntityStore"),v),Lv$(c,X,O)])}).then(function(){f$(c,r,O);
return r})},ph7=function(c,I,O){I=I.map(function(r){return qu(c,r,O)});
return g.U2.all(I)},w0=function(c,I,O){if(O==null?0:O.L8){var r=new Set;
return Unt(c,I,r).then(function(){for(var X=[],v=g.W(r),M=v.next();!M.done;M=v.next())X.push(w0(c,M.value));return g.U2.all(X).then(function(){})})}var u=g.Pe(I).entityType;
return g.U2.all([c.C.objectStore("EntityStore").delete(I),Cms(c,I)]).then(function(){f$(c,I,u)})},tHt=function(c,I){return g.Su(c.C.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(I)},function(O){return g.U2.all([O.delete(),
Cms(c,O.cursor.primaryKey)]).then(function(){f$(c,O.cursor.primaryKey,I);return g.KK(O)})})},Hgb=function(c,I,O,r){var u=Jba(c.N,1);
return Si(c,I,r).then(function(X){if(X){X=g.Nf(X,O);var v={key:I,entityType:r,data:Abk(u,X,I),version:1};return g.U2.all([g.FV(c.C.objectStore("EntityStore"),v),Lv$(c,X,r)])}}).then(function(){f$(c,I,r);
return I})},f$=function(c,I,O){var r=c.W[O];
r||(r=new Set,c.W[O]=r);r.add(I)},lNa=function(c,I,O){var r=PmY(I);
O=WvL(O);if(!O)return g.U2.resolve([]);O=new O(I);c=c.C.objectStore("EntityAssociationStore");I=[];O=g.W(O.N());for(var u=O.next();!u.done;u=O.next())I.push(g.FV(c,{parentEntityKey:r,childEntityKey:u.value}));return g.U2.all(I).then(function(X){return X.map(function(v){return v[1]})})},Cms=function(c,I){return c.C.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(I))},Lv$=function(c,I,O){var r=PmY(I);
return Cms(c,r).then(function(){return lNa(c,I,O)})},Unt=function(c,I,O){if(O.has(I))return g.U2.resolve(void 0);
O.add(I);return THs(c,I).then(function(r){return c.C.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(I)).then(function(){return r})}).then(function(r){var u=g.U2.resolve(void 0);
r=g.W(r);for(var X=r.next(),v={};!X.done;v={fK:void 0},X=r.next())v.fK=X.value,u=u.then(function(M){return function(){return Unt(c,M.fK,O)}}(v));
return u}).then(function(){})},THs=function(c,I){var O=c.C.objectStore("EntityAssociationStore");
return O.index("byParentEntityKey").getAll(IDBKeyRange.only(I)).then(function(r){var u=[];r=g.W(r);for(var X=r.next();!X.done;X=r.next())X=X.value,u.push(O.index("byChildEntityKey").getAll(X.childEntityKey));return g.U2.all(u)}).then(function(r){var u=[];
r=g.W(r);for(var X=r.next();!X.done;X=r.next())X=X.value,X.length===1&&u.push(X[0].childEntityKey);return u})},d0=function(){},E5Y=function(){this.C={};
this.C[0]=new d0;if(!g.Ly("aes_pes_encoder_killswitch")){var c=this.C;try{var I=g.x1();var O=NHz(I);var r=new Bm(new g.LJ(O),new g.Yv(O))}catch(u){throw c=u instanceof Error?new K$("KEY_CREATION_FAILED",{Ym:u.message}):new K$("KEY_CREATION_FAILED"),g.F8(c),c;}c[1]=r}},Jba=function(c,I){I=I===void 0?0:I;
c=c.C[I];if(!c)throw I=new K$("INVALID_ENCODER_VERSION",{sx:I}),g.F8(I),I;return c},Rk=function(c,I){g.k.call(this);
this.token=c;this.C=I;this.observers=[];c=new g.kU.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.x1());c.onmessage=this.N.bind(this);this.channel=c},xk=function(c,I,O){var r,u,X,v;
return g.E(function(M){if(M.C==1)return g.l(M,ig7(c.token),2);if(M.C!=3)return r=M.N,g.l(M,g.eu(r,["EntityStore","EntityAssociationStore"],I,function(G){u=new ybk(G,c.C);return O(u)}),3);
X=M.N;u&&(v=u.W,Object.keys(v).length>0&&(c.channel.postMessage(v),bgs(c,v)));return M.return(X)})},Z$=function(c,I,O){return xk(c,{mode:"readwrite",
Zw:!0},function(r){return qu(r,I,O)})},e8k=function(c,I){return xk(c,{mode:"readwrite",
Zw:!0},function(O){return ph7(O,I,"offlineOrchestrationActionWrapperEntity")})},Fva=function(c,I){return xk(c,{mode:"readwrite",
Zw:!0},function(O){return w0(O,I)})},$nX=function(c){return xk(c,{mode:"readwrite",
Zw:!0},function(I){return tHt(I,"videoPlaybackPositionEntity")})},zK=function(c,I,O){return xk(c,{mode:"readonly",
Zw:!0},function(r){return Si(r,I,O)})},Qp=function(c,I,O){return xk(c,{mode:"readonly",
Zw:!0},function(r){return g0(r,I,O)})},bgs=function(c,I){c=g.W(c.observers);
for(var O=c.next();!O.done;O=c.next())O=O.value,O(I)},aNb=function(){var c,I,O;
return g.E(function(r){if(r.C==1)return g.yy(r,2),g.l(r,g.cl(),4);if(r.C!=2){c=r.N;if(!c||!g.Zg()||typeof g.kU.BroadcastChannel==="undefined")return r.return();I=new E5Y;return r.return(new Rk(c,I))}O=g.Lz(r);O instanceof Error&&g.F8(O);return r.return()})},cy=function(){o5k||(o5k=aNb());
return o5k},kGt=function(c){var I;
c=(I=c.options)==null?void 0:I.persistenceOption;return c==="ENTITY_PERSISTENCE_OPTION_PERSIST"||c==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},Kva=function(c){var I;
return g.E(function(O){return O.C==1?g.l(O,cy(),2):(I=O.N)?g.l(O,xk(I,"readwrite",function(r){for(var u={},X=g.W(c),v=X.next(),M={};!v.done;M={gw:void 0,He:void 0},v=X.next())M.gw=v.value,M.gw.entityKey&&kGt(M.gw)&&(M.He=g.pG(M.gw.payload),v=void 0,M.gw.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(v=function(G){return function(){return qu(r,G.gw.payload[G.He],G.He)}}(M)),M.gw.type==="ENTITY_MUTATION_TYPE_DELETE"&&(v=function(G){return function(){return w0(r,G.gw.entityKey)}}(M)),M.gw.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(v=function(G){return function(){return Hgb(r,G.gw.entityKey,G.gw.payload[G.He],G.He)}}(M)),v&&(u[M.gw.entityKey]=u[M.gw.entityKey]?u[M.gw.entityKey].then(v):v()));
return g.U2.all(Object.values(u))}),0):O.return()})},BHt=function(c){var I;
return g.E(function(O){if(O.C==1){I=c.mutations;if(!I||I.length<=0)return O.return();if(g.zq){var r={type:"ENTITY_LOADED"};I!==void 0&&(r.payload=I);g.zq.dispatch(r)}return g.l(O,Kva(I),2)}I.length=0;g.WF(O)})},Ses=function(c){return c!==void 0},g5t=function(c){var I=g.pd();
I=Object.assign({},I);c=Object.assign({},c);for(var O in I)c[O]?(I[O]!==4&&(I[O]=c[O]),delete c[O]):I[O]!==2&&(I[O]=4);Object.assign(I,c);g.wUi(I);JSON.stringify(I);return I},fNO=function(c){var I,O;
return g.E(function(r){if(r.C==1)return g.l(r,g.cl(),2);if(r.C!=3)return(I=r.N)?g.l(r,g.tO(I),3):r.return();O=r.N;return r.return(g.eu(O,["index","media","captions"],{mode:"readwrite",Zw:!0},function(u){var X=IDBKeyRange.bound(c+"|",c+"~");u=[u.objectStore("index").delete(X),u.objectStore("media").delete(X),u.objectStore("captions").delete(X)];return g.U2.all(u).then(function(){})}))})},qes=function(){var c,I;
return g.E(function(O){if(O.C==1)return g.l(O,g.cl(),2);if(O.C!=3){c=O.N;if(!c)throw g.LK("rvdfd");return g.l(O,g.tO(c),3)}I=O.N;return O.return(g.eu(I,["index","media"],{mode:"readwrite",Zw:!0},function(r){var u={};return g.ks(r.objectStore("index"),{},function(X){var v=X.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),M=g.U2.resolve(void 0);if(v){var G=v[1];v=v[2];u[G]=u[G]||{};var m;u[G][v]=g.Zbx((m=X.getValue())==null?void 0:m.fmts)}else M=X.delete().then(function(){});
return g.U2.all([g.KK(X),M]).then(function(n){return g.W(n).next().value})}).then(function(){for(var X={},v=g.W(Object.keys(u)),M=v.next();!M.done;M=v.next()){M=M.value;
var G=u[M].v;X[M]=u[M].a&&G?1:2}var m=g5t(X);return g.ljx(r.objectStore("media"),{},function(n){var h=n.cursor.key.match(g.I9U);h&&X[h[1]]||r.objectStore("media").delete(n.cursor.key);return g.y9z(n)}).then(function(){return m})})}))})},whY=function(c,I){var O,r;
return g.E(function(u){if(u.C==1)return g.l(u,g.cl(),2);if(u.C!=3){O=u.N;if(!O)throw g.LK("wct");return g.l(u,g.tO(O),3)}r=u.N;return g.l(u,g.eu(r,["captions"],{mode:"readwrite",Zw:!0},function(X){var v=[];X=X.objectStore("captions");for(var M=0;M<I.length;M++){var G=g.FV(X,I[M],c+"|"+I[M].metadata.vss_id);v.push(G)}return g.U2.all(v)}),0)})},dnk=function(c){var I,O,r;
return g.E(function(u){if(u.C==1)return I=IDBKeyRange.bound(c+"|",c+"~"),g.l(u,g.cl(),2);if(u.C!=3){O=u.N;if(!O)throw g.LK("gactfv");return g.l(u,g.tO(O),3)}r=u.N;return u.return(r.getAll("captions",I))})},R8z=function(c){return g.E(function(I){g.Cd(c,0);
return I.return(fNO(c))})},spY=function(c){return{context:g.zF(),
videoIds:c}},xnL=function(c){return{context:g.zF(),
playlistIds:c}},Zg$=function(c){return{context:g.zF(),
offlinePlaylistSyncChecks:c}},z8O=function(){this.C=new Map},c_b=function(){QpY||(QpY=new z8O);
return QpY},IT7=function(c,I){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:c},metadata:I,statusCode:void 0,csn:void 0,can:void 0}},Ots=function(c,I,O){if(!O){var r=r===void 0?!1:r;
O=c.C.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!O||r)O=g.pR(16),c.C.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",O)}c={flowNonce:O,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:I.eventType};I.metadata&&(c.flowMetadata=I.metadata);I.statusCode!==void 0&&(c.flowEventStatus=I.statusCode);I.csn&&(c.csn=I.csn);I.can&&(c.can=I.can);g.ju("flowEvent",c,void 0)},r_L=function(c){var I,O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv,rL,Au,p,C,H;
return g.E(function(b){if(b.C==1)return g.l(b,xk(c,{mode:"readonly",Zw:!0},function(F){return g0(F,"playbackData").then(function(IZ){var Xx=IZ.map(function(Af){return Af.transfer}).filter(function(Af){return!!Af}),vF=IZ.map(function(Af){return Af.offlineVideoPolicy}).filter(function(Af){return!!Af}),e=IZ.filter(function(Af){return!!Af.key}).map(function(Af){return g.MA(g.Pe(Af.key).entityId,"downloadStatusEntity")});
Xx=g0(F,"transfer",Xx);vF=g0(F,"offlineVideoPolicy",vF);e=g0(F,"downloadStatusEntity",e);var jU=Xx.then(function(Af){Af=Af.reduce(function(iF,Ed){(Ed==null?0:Ed.offlineVideoStreams)&&iF.push.apply(iF,g.Y(Ed.offlineVideoStreams));return iF},[]).filter(function(iF){return!!iF});
return g0(F,"offlineVideoStreams",Af)});
return g.U2.all([Xx,vF,jU,e]).then(function(Af){var iF=g.W(Af);Af=iF.next().value;var Ed=iF.next().value;var n7=iF.next().value;iF=iF.next().value;return[IZ,Af,Ed,n7,iF]})})}),2);
if(b.C!=3)return I=b.N,g.l(b,xk(c,{mode:"readonly",Zw:!0},function(F){return g0(F,"mainDownloadsListEntity").then(function(IZ){var Xx,vF;return(vF=(Xx=IZ[0])==null?void 0:Xx.downloads)!=null?vF:[]})}),3);
O=b.N;r=g.W(I);u=r.next().value;X=r.next().value;v=r.next().value;M=r.next().value;G=r.next().value;m=u;n=X;h=v;V=M;A=G;N={};J={};L={};U={};t={};T=[];a=g.W(n);for(K=a.next();!K.done;K=a.next())(R=K.value)&&(N[R.key]=R);d=g.W(h);for(uF=d.next();!uF.done;uF=d.next())(PF=uF.value)&&(J[PF.key]=PF);cF=g.W(A);for(f=cF.next();!f.done;f=cF.next())(Q=f.value)&&(L[Q.key]=Q);y=g.W(V);for(q=y.next();!q.done;q=y.next())(BF=q.value)&&(U[BF.key]=BF);Ju=g.W(O);for(mk=Ju.next();!mk.done;mk=Ju.next())tf=mk.value,Zv=
void 0,t[(Zv=tf.videoItem)!=null?Zv:""]=!0,tf.videoItem&&(Au=rL=void 0,p=(Au=(rL=g.Pe(tf.videoItem))==null?void 0:rL.entityId)!=null?Au:"",T.push({externalVideoId:p}));C=m.filter(function(F){if(!F||!F.key||!F.offlineVideoPolicy)return!1;F=g.Pe(F.key).entityId;F=g.MA(F,"downloadStatusEntity");var IZ;return!(F&&((IZ=L[F])==null?void 0:IZ.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
H=C.map(function(F){var IZ=N[F.transfer],Xx=[];if(IZ==null?0:IZ.offlineVideoStreams)for(var vF=g.W(IZ.offlineVideoStreams),e=vF.next();!e.done;e=vF.next())(e=U[e.value])&&Xx.push(e);vF=J[F.offlineVideoPolicy];e=t;var jU=F==null?void 0:F.playerResponseTimestamp,Af=g.Pe(vF.key).entityId;F=g.MA(Af,"mainVideoEntity");if(vF.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var iF="OFFLINE_VIDEO_STATE_DISABLED";vF.expirationTimestamp&&Number(vF.expirationTimestamp)<Date.now()/1E3&&(iF="OFFLINE_VIDEO_STATE_EXPIRED")}else if(vF.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")iF="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(IZ==null?void 0:IZ.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":iF="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":iF="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":iF="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":iF="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":iF="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":iF="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:iF="OFFLINE_VIDEO_STATE_UNKNOWN"}if(iF==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(IZ==null?void 0:IZ.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":iF="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":iF="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":iF=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}Af={id:Af,videoState:iF};if(IZ==null?0:IZ.cotn)Af.cotn=IZ.cotn;if(IZ==null?0:IZ.maximumDownloadQuality)Af.selectedVideoQuality=IZ==null?void 0:IZ.maximumDownloadQuality;if(IZ==null?0:IZ.lastProgressTimeMs)Af.lastProgressTimeMs=IZ.lastProgressTimeMs;jU&&(Af.playerResponseSavedTimeMs=String(Number(jU)*1E3));IZ=String;jU=0;Xx=g.W(Xx);for(iF=Xx.next();!iF.done;iF=Xx.next())if(iF=iF.value,iF.streamsProgress){iF=g.W(iF.streamsProgress);for(var Ed=iF.next();!Ed.done;Ed=
iF.next()){var n7=void 0;jU+=Number((n7=Ed.value.numBytesDownloaded)!=null?n7:0)}}Af.downloadedBytes=IZ(jU);Af.selectedOfflineMode=e[F]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";vF.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&(Af.offlinePlaybackDisabledReason=vF.offlinePlaybackDisabledReason);return Af});
return b.return({offlineVideos:H,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:T}}})})},ubu=function(){this.locks=navigator.locks},X6$=function(){try{var c=g.SU("ytglobal.locks_");
if(c)return c;var I;if(I=navigator){var O=navigator;I="locks"in O&&!!O.locks}if(I)return g.kU.localStorage&&g.kU.localStorage.getItem("noop"),c=new ubu,g.Kz("ytglobal.locks_",c),c}catch(r){}},IP=function(){},vtz=function(){},Puz=function(c){if(c.includes(":"))throw Error("Invalid user cache name: "+c);
return c+":"+g.x1("CacheStorage get")},MQk=function(){return g.E(function(c){if(Of!==void 0)return c.return(Of);
Of=new Promise(function(I){var O;return g.E(function(r){switch(r.C){case 1:return g.yy(r,2),g.l(r,rD.open("test-only"),4);case 4:return g.l(r,rD.delete("test-only"),5);case 5:g.YU(r,3);break;case 2:if(O=g.Lz(r),O instanceof Error&&O.name==="SecurityError")return I(!1),r.return();case 3:I("caches"in window),g.WF(r)}})});
return c.return(Of)})},GZa=function(){return g.E(function(c){if(c.C==1)return g.l(c,MQk(),2);
if(!c.N)return c.return(void 0);ita||(ita=new vtz);return c.return(ita)})},uj=function(c,I,O){g.$S(new g.sZ("Woffle: "+c,O?{cotn:O}:""));
I instanceof Error&&g.$S(I)},jDO=function(c){var I;
return g.E(function(O){if(O.C==1)return g.l(O,r_L(c),2);I=O.N;g.ju("offlineStateSnapshot",I);g.WF(O)})},Xr=function(c){g.k.call(this);
var I=this;this.api=c;this.x5={Gu0:function(){return I.C},
KVP:function(){return I.N}};
typeof g.kU.BroadcastChannel!=="undefined"&&(this.C=new g.kU.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.x1()),this.C.onmessage=this.W.bind(this),this.N=new g.kU.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.x1()),this.N.onmessage=this.Y.bind(this))},vy=function(c,I){c.api.XV("onOfflineOperationFailure",I);
var O;(O=c.C)==null||O.postMessage(I)},m87=function(c,I,O,r){var u=this;
this.K=c;this.j=I;this.visibility=O;this.B=r;this.L=this.V=this.G=this.W=this.C=!1;this.Y=new g.IW(function(){u.KW()});
this.x5={tW:function(){return u.N},
KW:function(){u.KW()},
ECq:function(){return u.Y}};
this.visibility.subscribe("visibilitystatechange",function(){u.Ng()})},ntO=function(c){if(!c.W&&!c.C){var I=X6$();
if(I){c.W=!0;var O=g.x1("OfflineLockManager");I.request("woffle_orchestration_leader:"+O,{},function(){var r,u,X,v;return g.E(function(M){switch(M.C){case 1:return g.yy(M,2),c.N=new g.Am,c.C=!0,c.W=!1,g.l(M,c.K(),4);case 4:return g.l(M,c.N.promise,5);case 5:g.YU(M,0);break;case 2:r=g.Lz(M),((X=(u=c).B)==null?0:X.call(u,"wo_relinquish_leadership_on_lock_request_error"))||c.KW(),r instanceof Error&&(v=r,v.args=[{name:"WoLockManagerError",un:r.name}],g.F8(v)),g.WF(M)}})})}}},hyu=function(c){c.C&&(c.L=
!0,Py(c))},VQb=function(c,I){c.C&&(c.G=I,Py(c))},A_L=function(c,I){c.C&&(c.V=I,Py(c))},Py=function(c){c.V&&c.G&&c.L&&c.visibility.isBackground()?g.O$(c.Y,6E4):c.Y.stop()},M7=function(c){var I;
c.offlineDeleteReason=(I=c.offlineDeleteReason)!=null?I:"OFFLINE_DELETE_REASON_UNKNOWN";var O;c.offlineModeType=(O=c.offlineModeType)!=null?O:"OFFLINE_NOW";g.ju("offlineDeleteEvent",c)},ij=function(c,I){var O=I.videoId;
var r=I.Nb;I=I.offlineModeType;c.encryptedVideoId=O;c.cotn=r==null?void 0:r.cotn;c.offlineabilityFormatType=r==null?void 0:r.maximumDownloadQuality;var u;c.isRefresh=(u=r==null?void 0:r.isRefresh)!=null?u:!1;var X;c.softErrorCount=(X=r==null?void 0:r.transferRetryCount)!=null?X:0;c.offlineModeType=I!=null?I:"OFFLINE_NOW";(c.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&c.statusType==="UNKNOWN_STATUS_TYPE"||!c.transferStatusType&&!c.statusType)&&g.$S(Error("Woffle unknown transfer status"));
g.ju("offlineTransferStatusChanged",c)},NJu=function(c,I,O,r){r={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!r};I&&O&&(I=Math.floor(I/1024).toFixed(),O=Math.floor(O/1024).toFixed(),r.alreadyDownloadedKbytes=I,r.totalFetchedKbytes=I,r.totalContentKbytes=O);ij(r,c)},D8O=function(c){ij({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},c)},Wes=function(c){switch(c){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
G5=function(c){var I,O,r;
return((r=(I=c.actionMetadata)==null?void 0:(O=I.retryScheduleIntervalsInSeconds)==null?void 0:O.length)!=null?r:0)>0},jD=function(c){return c.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!c.entityKey},mY=function(c){return c.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!c.entityKey},nI=function(c){return c.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!c.entityKey},y_L=function(c){return c.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!c.entityKey},
hn=function(c,I,O,r,u){u=u===void 0?!1:u;
var X,v,M,G,m,n;return g.E(function(h){if(h.C==1)return X=g.MA(c,I),v=g.MA(c,"downloadStatusEntity"),g.l(h,xk(O,{mode:"readonly",Zw:!0},function(V){return g.U2.all([Si(V,X,I),Si(V,v,"downloadStatusEntity")])}),2);
M=h.N;G=M.length?M[0]:void 0;if(!G)return h.GF(0);m=J_O;if(n=M.length>1?M[1]:void 0){if(n.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!u)return h.return();n.downloadState=r}else n={key:v,downloadState:r};g.B4(G,m,n);return g.l(h,xk(O,{mode:"readwrite",Zw:!0},function(V){return g.U2.all([qu(V,G,I),qu(V,n,"downloadStatusEntity")])}),0)})},Vc=function(c,I){return c.actionType===I.actionType&&c.entityKey===I.entityKey},An=function(c,I){if(c&&c.transferState!=="TRANSFER_STATE_COMPLETE"&&c.transferState!==
"TRANSFER_STATE_FAILED"){var O=g.Pe(c.key).entityId;
ij({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:O,Nb:c,offlineModeType:I})}},N7=function(c){if(!c||!c.thumbnails)return[];
var I=[];c=g.W(c.thumbnails);for(var O=c.next();!O.done;O=c.next())O=O.value,O.url&&I.push(O.url);return I},Y0Y=function(c,I,O){O=O===void 0?[]:O;
var r,u,X,v,M,G,m,n,h,V,A,N,J;return g.E(function(L){if(L.C==1)return O.length?g.l(L,Qp(c,I),2):L.return([]);r=L.N;u=new Set;X=g.W(r);for(v=X.next();!v.done;v=X.next())if(M=v.value,G=M.id||M.key)m=g.Pe(G).entityId,u.add(m);n=[];h=g.W(O);for(V=h.next();!V.done;V=h.next())A=V.value,N=A.offlineVideoData,J=void 0,((J=N)==null?0:J.videoId)&&!u.has(N.videoId)&&n.push(A);return L.return(n)})},LeY=function(c,I,O){return new g.Kd(c,{cotn:I,
raw_player_response:O,download_media:!0,start:Infinity,disable_watch_next:!0})},p6$=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},DD=function(c,I,O,r,u,X,v,M,G,m,n){this.entityType=c;
this.actionId=I;this.action=O;this.parentActionId=r;this.rootActionId=u===void 0?I:u;this.childActionIds=X;this.prereqActionId=v;this.postreqActionIds=M;this.hasChildActionFailed=m;this.retryScheduleIndex=0;this.C=n||Date.now();this.retryScheduleIndex=G||0},Wy=function(c){if(!c.key)throw Error("Entity key is required.");
if(!c.actionProto)throw Error("OfflineOrchestrationAction is required.");var I=g.Pe(c.key),O=g.Pe(c.actionProto.entityKey);return new DD(O.entityType,I.entityId,c.actionProto,c.parentActionId,c.rootActionId,c.childActionIds,c.prereqActionId,c.postreqActionIds,c.retryScheduleIndex,c.hasChildActionFailed,Number(c.enqueueTimeSec)*1E3)},yc=function(c){return{key:g.MA(c.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:c.action,parentActionId:c.parentActionId,rootActionId:c.rootActionId,childActionIds:c.childActionIds,prereqActionId:c.prereqActionId,postreqActionIds:c.postreqActionIds,retryScheduleIndex:c.retryScheduleIndex,hasChildActionFailed:c.hasChildActionFailed,enqueueTimeSec:(c.C/1E3).toFixed()}},U8b=function(){var c;
return g.E(function(I){return I.C==1?g.l(I,GZa(),2):(c=I.N)?I.return(c.delete("yt-player-local-img")):I.return(!0)})},Jn=function(c){var I,O;
return g.E(function(r){if(r.C==1)return g.l(r,GZa(),2);if(r.C!=3){I=r.N;if(!I)throw Error("Cache API not supported");return c.length?g.l(r,I.open("yt-player-local-img"),3):r.return()}O=r.N;return g.l(r,Promise.all(c.map(function(u){return O.delete(u)})),0)})},Y4=function(c){var I,O;
return g.E(function(r){if(r.C==1)return g.l(r,GZa(),2);if(r.C!=3){I=r.N;if(!I)throw Error("Cache API not supported");return c.length?g.l(r,I.open("yt-player-local-img"),3):r.return()}O=r.N;return g.l(r,O.addAll(c),0)})},LI=function(c,I,O,r,u){var X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv;
return g.E(function(rL){switch(rL.C){case 1:return X=g.MA(c,"mainVideoEntity"),v=g.MA(c,"ytMainChannelEntity"),M=g.MA(c,"transfer"),G=g.MA(c,"videoDownloadContextEntity"),g.l(rL,xk(I,{mode:"readonly",Zw:!0},function(Au){return g.U2.all([Si(Au,X,"mainVideoEntity"),Si(Au,v,"ytMainChannelEntity"),Si(Au,M,"transfer"),Si(Au,G,"videoDownloadContextEntity"),g0(Au,"ytMainChannelEntity"),g0(Au,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:m=rL.N;n=g.W(m);h=n.next().value;V=n.next().value;A=n.next().value;N=n.next().value;J=n.next().value;L=n.next().value;U=h;t=V;T=A;a=N;K=J;R=L;if(!U&&!t){rL.GF(3);break}d=U?N7(U.thumbnail):[];if(!t){uF=[];rL.GF(4);break}return g.l(rL,Cuk(t,K),5);case 5:uF=rL.N;case 4:return PF=uF,g.l(rL,Jn(d.concat(PF)),3);case 3:cF=[];f=g.MA(c,"downloadStatusEntity");Q=g.W(R);for(y=Q.next();!y.done;y=Q.next())q=y.value,BF=g.Pe(q.key).entityId,Ju=Wy(q),mk=g.Pe(Ju.action.entityKey).entityId,BF!==c&&mk!==c||Vc(O,
q.actionProto)||cF.push(q.key);return g.l(rL,xk(I,{mode:"readwrite",Zw:!0},function(Au){var p=cF.map(function(C){return w0(Au,C)});
p.push(w0(Au,X,{L8:!0}));p.push(w0(Au,f,{L8:!0}));return g.U2.all(p)}),7);
case 7:Zv=(tf=a)==null?void 0:tf.offlineModeType,u&&(M7(u),u.offlineModeType&&(Zv=u.offlineModeType)),An(T,Zv),vy(r,{entityKey:X,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.WF(rL)}})},lTL=function(c,I,O,r){var u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv,rL,Au,p,C,H,b,F,IZ,Xx,vF,e,jU,Af,iF,Ed,n7,K7,nU;
return g.E(function(qm){switch(qm.C){case 1:return u=g.MA(c,"mainPlaylistEntity"),X=g.MA(c,"ytMainChannelEntity"),g.l(qm,xk(I,{mode:"readonly",Zw:!0},function(KU){return g.U2.all([Si(KU,u,"mainPlaylistEntity"),Si(KU,X,"ytMainChannelEntity"),g0(KU,"mainPlaylistEntity"),g0(KU,"mainDownloadsListEntity"),g0(KU,"ytMainChannelEntity"),g0(KU,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:v=qm.N;M=g.W(v);G=M.next().value;m=M.next().value;n=M.next().value;h=M.next().value;V=M.next().value;A=M.next().value;N=G;J=m;L=n;U=h;t=V;T=A;if(!N&&!J){qm.GF(3);break}a=N?tQu(N):[];if(!J){K=[];qm.GF(4);break}return g.l(qm,Cuk(J,t),5);case 5:K=qm.N;case 4:return R=K,g.l(qm,Jn(a.concat(R)),3);case 3:d=[];uF=new Map;if(!N){qm.GF(7);break}return g.l(qm,HtY(N,L,U),8);case 8:d=qm.N;PF=g.W(d);for(cF=PF.next();!cF.done;cF=PF.next())f=cF.value,uF.set(f,{videoId:f,playlistId:c,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.l(qm,xk(I,{mode:"readonly",Zw:!0},function(KU){return g.U2.all([g0(KU,"transfer"),g0(KU,"videoDownloadContextEntity")])}),9);
case 9:Q=qm.N;y=g.W(Q);q=y.next().value;BF=y.next().value;Ju=q;mk=BF;tf=g.W(Ju);for(Zv=tf.next();!Zv.done;Zv=tf.next())rL=Zv.value,Au=g.Pe(rL.key).entityId,(p=uF.get(Au))&&rL&&(p.cotn=rL.cotn);C=g.W(mk);for(H=C.next();!H.done;H=C.next())b=H.value,F=g.Pe(b.key).entityId,(IZ=uF.get(F))&&b&&(IZ.offlineModeType=b.offlineModeType);case 7:Xx=[];vF=g.W(T);for(e=vF.next();!e.done;e=vF.next())jU=e.value,Af=g.Pe(jU.key).entityId,iF=Wy(jU),Af!==c&&iF.rootActionId!==c||Vc(O,jU.actionProto)||Xx.push(jU.key);Ed=
g.MA(c,"mainPlaylistEntity");return g.l(qm,xk(I,{mode:"readwrite",Zw:!0},function(KU){var jE=Xx.map(function(ef){return w0(KU,ef)});
jE.push(w0(KU,Ed,{L8:!0}));return g.U2.all(jE)}),10);
case 10:if(!N){qm.GF(0);break}d.reverse();if(!d){qm.GF(0);break}n7=g.W(d);K7=n7.next();case 13:if(K7.done){qm.GF(0);break}nU=K7.value;return g.l(qm,LI(nU,I,O,r,uF.get(nU)),14);case 14:K7=n7.next(),qm.GF(13)}})},EtL=function(c,I,O,r){var u,X,v,M,G,m,n,h,V;
return g.E(function(A){if(A.C==1)return u=g.MA("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),X=new Map,g.l(A,xk(c,{mode:"readwrite",Zw:!0},function(N){var J=g0(N,"transfer"),L=g0(N,"offlineOrchestrationActionWrapperEntity"),U=g0(N,"videoDownloadContextEntity"),t=Si(N,u,"mainDownloadsListEntity");return g.U2.all([J,L,U,t]).then(function(T){T=g.W(T);var a=T.next().value;var K=T.next().value;var R=T.next().value;var d=T.next().value;T=TJX.map(function(PF){return tHt(N,PF)});
K=g.W(K);for(var uF=K.next();!uF.done;uF=K.next())uF=uF.value,Vc(I,uF.actionProto)||T.push(w0(N,uF.key,{L8:!0}));d&&(d.downloads=[],T.push(qu(N,d,"mainDownloadsListEntity")));if(R)for(R=g.W(R),d=R.next();!d.done;d=R.next())d=d.value,K=g.Pe(d.key).entityId,K=g.MA(K,"transfer"),X.set(K,d.offlineModeType);return g.U2.all(T).then(function(){return a})})}),2);
v=A.N;M=g.W(v);for(G=M.next();!G.done;G=M.next())m=G.value,An(m,X.get(m.key)),n=g.Pe(m.key).entityId,h={videoId:n,offlineDeleteReason:r,cotn:m.cotn,offlineModeType:X.get(m.key)},M7(h),V=g.MA(n,"mainVideoEntity"),vy(O,{entityKey:V,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.l(A,U8b(),0)})},tQu=function(c,I){var O=[];
if(c.thumbnailStyleData){c=g.W(c.thumbnailStyleData);for(var r=c.next();!r.done;r=c.next()){var u=void 0,X=void 0,v=void 0;O=O.concat(N7((u=r.value)==null?void 0:(X=u.value)==null?void 0:(v=X.collageThumbnail)==null?void 0:v.coverThumbnail))}}I=N7(I);return O.concat(I)},HtY=function(c,I,O){var r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF;
return g.E(function(cF){r=[];u=new Set;if(O.length)for(X=g.W(O),v=X.next();!v.done;v=X.next())if(M=v.value,G=void 0,(G=M.downloads)==null?0:G.length)for(m=g.W(M.downloads),n=m.next();!n.done;n=m.next())h=n.value,h.videoItem&&(V=g.Pe(h.videoItem).entityId,u.add(V));if(c.videos){A=g.W(c.videos);for(N=A.next();!N.done;N=A.next())J=N.value,L=JSON.parse(g.Pe(J).entityId),L.videoId&&!u.has(L.videoId)&&r.push(L.videoId);U=g.W(I);for(t=U.next();!t.done;t=U.next())if(T=t.value,T.key!==c.key&&(a=T.videos))for(K=
g.W(a),R=K.next();!R.done;R=K.next())d=R.value,uF=JSON.parse(g.Pe(d).entityId),uF.videoId&&(PF=r.indexOf(uF.videoId),PF!==-1&&r.splice(PF,1))}return cF.return(r)})},Cuk=function(c,I){var O,r,u,X,v,M,G,m;
return g.E(function(n){O=N7(c.avatar);r=g.W(I);for(u=r.next();!u.done;u=r.next())if(X=u.value,X.id!==c.id)for(v=g.W(N7(X.avatar)),M=v.next();!M.done;M=v.next())G=M.value,m=O.indexOf(G),m!==-1&&O.splice(m,1);return n.return(O)})},btk=function(c){var I;
return g.E(function(O){I=g.S(c.frameworkUpdates,pI);return c.frameworkUpdates&&I?g.l(O,BHt(I),0):O.return()})},Fea=function(c){var I;
if((I=c.onResponseReceivedActions)!=null&&I.length){var O;c=(O=g.S(g.S(c.onResponseReceivedActions[0],eyL),g.Z7Y))==null?void 0:O.actions;if(c!=null&&c.length)return c}},$8a=function(c){var I,O,r;
return g.E(function(u){if(u.C==1)return c?g.l(u,zK(c,g.$c,"mainDownloadsListEntity"),2):u.return([]);I=u.N;return((O=I)==null?0:(r=O.downloads)==null?0:r.length)?u.return(I.downloads.map(function(X){var v;return(v=X.videoItem)!=null?v:""})):u.return([])})},ot7=function(c,I){var O;
return g.E(function(r){return r.C==1?g.l(r,aTO(c,I),2):(O=r.N)?g.l(r,xk(c,{mode:"readwrite",Zw:!0},function(u){var X=[qu(u,O.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];O.mainDownloadsListEntity&&X.push(qu(u,O.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.U2.all(X)}),0):r.GF(0)})},aTO=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T;
return g.E(function(a){if(a.C==1)return O=g.MA("main_downloads_library_id","mainDownloadsLibraryEntity"),r=g.MA("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.l(a,xk(c,{mode:"readonly",Zw:!0},function(K){return g.U2.all([Si(K,O,"mainDownloadsLibraryEntity"),Si(K,r,"mainDownloadsListEntity")])}),2);
u=a.N;X=g.W(u);v=X.next().value;M=X.next().value;G=v;m=M;G||(G={id:O});n=g.W(I);for(h=n.next();!h.done;h=n.next())if(V=h.value,V===g.$c){if(G.smartDownloadsList)return a.return();G.smartDownloadsList=V}else if(A=g.Pe(V).entityType,N={},A==="mainPlaylistEntity"?N.playlistItem=V:A==="mainVideoEntity"&&(N.videoItem=V),!g.T6(N)){J=void 0;if((J=m)==null?0:J.downloads){L=!1;U=g.W(m.downloads);for(t=U.next();!t.done;t=U.next())if(T=t.value,T.playlistItem===V||T.videoItem===V){L=!0;break}L||m.downloads.push(N)}else m=
{id:r,downloads:[N]};G.downloadsList=r}return a.return({mainDownloadsLibraryEntity:G,mainDownloadsListEntity:m})})},kZL=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L;
return g.E(function(U){if(U.C==1)return O=g.MA("main_downloads_library_id","mainDownloadsLibraryEntity"),r=g.MA("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.l(U,xk(c,{mode:"readonly",Zw:!0},function(t){return g.U2.all([Si(t,O,"mainDownloadsLibraryEntity"),Si(t,r,"mainDownloadsListEntity"),Si(t,g.$c,"mainDownloadsListEntity")])}),2);
u=U.N;X=g.W(u);v=X.next().value;M=X.next().value;G=X.next().value;m=v;n=M;h=G;if(!m)return U.GF(0);if(I===g.$c&&((V=h)==null?0:V.downloads))h.downloads=[];else if((A=n)==null?0:A.downloads)for(N=g.Pe(I).entityType,J=0;J<n.downloads.length;J++)if(L=n.downloads[J],N==="mainVideoEntity"&&L.videoItem===I){n.downloads.splice(J,1);break}else if(N==="mainPlaylistEntity"&&L.playlistItem===I){n.downloads.splice(J,1);break}return g.l(U,xk(c,{mode:"readwrite",Zw:!0},function(t){var T=[qu(t,m,"mainDownloadsLibraryEntity")];
n&&T.push(qu(t,n,"mainDownloadsListEntity"));h&&T.push(qu(t,h,"mainDownloadsListEntity"));return g.U2.all(T)}),0)})},Uf=function(c,I){var O,r,u,X,v,M,G,m,n,h,V;
return g.E(function(A){if(A.C==1)return O=g.MA(I,"transfer"),r=g.MA(I,"videoDownloadContextEntity"),g.l(A,xk(c,{mode:"readonly",Zw:!0},function(N){return g.U2.all([Si(N,O,"transfer"),Si(N,r,"videoDownloadContextEntity")])}),2);
u=A.N;X=g.W(u);v=X.next().value;M=X.next().value;G=v;m=M;V={videoId:I,cotn:(n=G)==null?void 0:n.cotn,offlineModeType:(h=m)==null?void 0:h.offlineModeType};return A.return(V)})},CI=function(c,I,O,r,u){var X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF;
return g.E(function(PF){switch(PF.C){case 1:return X=g.MA(c,"musicTrack"),v=g.MA(c,"transfer"),g.l(PF,xk(I,{mode:"readonly",Zw:!0},function(cF){return g.U2.all([Si(cF,X,"musicTrack"),Si(cF,v,"transfer"),g0(cF,"musicTrack"),g0(cF,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:M=PF.N;G=g.W(M);m=G.next().value;n=G.next().value;h=G.next().value;V=G.next().value;A=m;N=n;J=h;L=V;if(!A){PF.GF(3);break}return g.l(PF,Kez(A,J),4);case 4:return U=PF.N,g.l(PF,Jn(U),3);case 3:t=[];T=g.W(L);for(a=T.next();!a.done;a=T.next())K=a.value,R=g.Pe(K.key).entityId,d=Wy(K),uF=g.Pe(d.action.entityKey).entityId,R!==c&&uF!==c||Vc(O,K.actionProto)||t.push(K.key);return g.l(PF,xk(I,{mode:"readwrite",Zw:!0},function(cF){var f=t.map(function(Q){return w0(cF,Q)});
f.push(w0(cF,X,{L8:!0}));return g.U2.all(f)}),6);
case 6:An(N),u&&M7(u),vy(r,{entityKey:X,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.WF(PF)}})},tn=function(c,I,O,r,u){var X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv,rL,Au,p,C,H;
return g.E(function(b){switch(b.C){case 1:return X=g.MA(c,I),v=g.MA("music_downloads_library_id","musicDownloadsLibraryEntity"),g.l(b,xk(O,{mode:"readonly",Zw:!0},function(F){return g.U2.all([Si(F,X,I),Si(F,v,"musicDownloadsLibraryEntity"),g0(F,I),g0(F,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:M=b.N;G=g.W(M);m=G.next().value;n=G.next().value;h=G.next().value;V=G.next().value;A=m;N=n;J=h;L=V;if(!A){b.GF(3);break}return g.l(b,Kez(A,J),4);case 4:return U=b.N,g.l(b,Jn(U),3);case 3:t=[];T=new Map;if(!A){b.GF(6);break}return g.l(b,BJ7(A,J,N),7);case 7:t=b.N;a=g.W(t);for(K=a.next();!K.done;K=a.next())R=K.value,d=g.Pe(R).entityId,T.set(d,{videoId:d,playlistId:c,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.l(b,Qp(O,"transfer"),8);case 8:for(uF=b.N,PF=g.W(uF),
cF=PF.next();!cF.done;cF=PF.next())f=cF.value,Q=g.Pe(f.key).entityId,(y=T.get(Q))&&f&&(y.cotn=f.cotn);case 6:q=[];BF=g.W(L);for(Ju=BF.next();!Ju.done;Ju=BF.next())mk=Ju.value,tf=g.Pe(mk.key).entityId,Zv=Wy(mk),tf!==c&&Zv.rootActionId!==c||Vc(r,mk.actionProto)||q.push(mk.key);rL=g.MA(c,I);return g.l(b,xk(O,{mode:"readwrite",Zw:!0},function(F){var IZ=q.map(function(Xx){return w0(F,Xx)});
IZ.push(w0(F,rL,{L8:!0}));return g.U2.all(IZ)}),9);
case 9:if(!A){b.GF(0);break}t.reverse();if(!t.length){b.GF(0);break}Au=g.W(t);p=Au.next();case 12:if(p.done){b.GF(0);break}C=p.value;H=g.Pe(C).entityId;if(!H){b.GF(13);break}return g.l(b,CI(H,O,r,u,T.get(H)),13);case 13:p=Au.next(),b.GF(12)}})},Hy=function(c,I,O){var r,u,X,v,M,G,m;
return g.E(function(n){if(n.C==1)return g.l(n,xk(c,{mode:"readwrite",Zw:!0},function(h){var V=g0(h,"transfer"),A=g0(h,"offlineOrchestrationActionWrapperEntity");return g.U2.all([V,A]).then(function(N){N=g.W(N);var J=N.next().value;var L=N.next().value;N=S0k.map(function(a){return tHt(h,a)});
L=g.W(L);for(var U=L.next();!U.done;U=L.next()){U=U.value;var t=g.Pe(U.actionProto.entityKey).entityType==="musicTrack",T=U.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";Vc(I,U.actionProto)||t&&(!t||T)||N.push(w0(h,U.key,{L8:!0}))}return g.U2.all(N).then(function(){return J})})}),2);
r=n.N;u=g.W(r);for(X=u.next();!X.done;X=u.next())v=X.value,An(v),M=g.Pe(v.key).entityId,G={videoId:M,offlineDeleteReason:void 0,cotn:v.cotn},M7(G),m=g.MA(M,"musicTrack"),vy(O,{entityKey:m,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.l(n,U8b(),0)})},gtL=function(c){for(var I,O=g.W(c.additionalMetadatas),r=O.next();!r.done;r=O.next())r=r.value,r.offlineMusicVideoData&&(I=r.offlineMusicVideoData);
var u,X,v,M,G;return{id:g.MA(c.videoId,"musicTrack"),videoId:c.videoId,title:c.title,thumbnailDetails:c.thumbnail,lengthMs:String(Number(c.lengthSeconds)*1E3),albumTitle:(u=I)==null?void 0:u.releaseTitle,musicVideoType:(X=I)==null?void 0:X.musicVideoType,contentRating:{explicitType:(v=I)==null?void 0:v.explicitType},artistNames:((M=I)==null?void 0:M.byline)||((G=I)==null?void 0:G.channelName),downloadMetadata:g.MA(c.videoId,"musicTrackDownloadMetadataEntity")}},BJ7=function(c,I,O){var r,u,X,v,M,G,
m,n,h,V,A,N,J,L,U,t,T,a;
return g.E(function(K){r=[];u=new Set;if((X=O)==null?0:(v=X.downloadedTracks)==null?0:v.length)for(M=g.W(O.downloadedTracks),G=M.next();!G.done;G=M.next())m=G.value,u.add(m);if(c.tracks){n=g.W(c.tracks);for(h=n.next();!h.done;h=n.next())V=h.value,u.has(V)||r.push(V);A=g.W(I);for(N=A.next();!N.done;N=A.next())if(J=N.value,J.id!==c.id&&(L=J.tracks))for(U=g.W(L),t=U.next();!t.done;t=U.next())T=t.value,a=r.indexOf(T),a!==-1&&r.splice(a,1)}return K.return(r)})},Kez=function(c,I){var O,r,u,X,v,M,G,m;
return g.E(function(n){O=N7(c.thumbnailDetails);r=g.W(I);for(u=r.next();!u.done;u=r.next())if(X=u.value,X.id!==c.id)for(v=g.W(N7(X.thumbnailDetails)),M=v.next();!M.done;M=v.next())G=M.value,m=O.indexOf(G),m!==-1&&O.splice(m,1);return n.return(O)})},fT7=function(c,I){var O,r,u,X,v,M,G,m,n;
return g.E(function(h){if(h.C==1)return O=g.MA("music_downloads_library_id","musicDownloadsLibraryEntity"),g.l(h,zK(c,O,"musicDownloadsLibraryEntity"),2);(r=h.N)||(r={id:O});u=g.Pe(I).entityType;u==="musicTrack"?(X=r.downloadedTracks)!=null&&X.includes(I)||(r.downloadedTracks=((v=r.downloadedTracks)!=null?v:[]).concat(I)):u==="musicPlaylist"?(M=r.downloadedPlaylists)!=null&&M.includes(I)||(r.downloadedPlaylists=((G=r.downloadedPlaylists)!=null?G:[]).concat(I)):u!=="musicAlbumRelease"||(m=r.downloadedAlbumReleases)!=
null&&m.includes(I)||(r.downloadedAlbumReleases=((n=r.downloadedAlbumReleases)!=null?n:[]).concat(I));return g.l(h,Z$(c,r,"musicDownloadsLibraryEntity"),0)})},q0X=function(c,I){var O,r,u,X,v,M,G;
return g.E(function(m){if(m.C==1)return O=g.MA("music_downloads_library_id","musicDownloadsLibraryEntity"),g.l(m,zK(c,O,"musicDownloadsLibraryEntity"),2);r=m.N;if(!r)return m.GF(0);u=g.Pe(I).entityType;u==="musicTrack"?X=r.downloadedTracks:u==="musicPlaylist"&&(X=r.downloadedPlaylists);if((v=X)==null?0:v.length)for(M=0;M<X.length;M++)if(G=X[M],G===I){X.splice(M,1);break}return g.l(m,Z$(c,r,"musicDownloadsLibraryEntity"),0)})},w67=function(c){var I=c.videos;
c=[];var O=[];if(I){I=g.W(I);for(var r=I.next();!r.done;r=I.next()){var u=r.value.offlineVideoData.videoId;r=g.MA(u,"musicTrack");u=g.MA(u,"musicTrackDownloadMetadataEntity");c.push(r);O.push(u)}}return{kz:c,iD:O}},lj=function(c,I,O){I={track:gtL(I)};
O&&(I.playlistId=O);if(c=g.S(c.actionMetadata,d8u))I.maximumDownloadQuality=c.maximumDownloadQuality;return{musicTrackEntityActionMetadata:I}},sDu=function(c){var I,O,r,u,X,v,M,G;
return g.E(function(m){switch(m.C){case 1:return I=g.vn(),O=spY(c),r=g.Iu(Ryu),g.yy(m,2),X={vF:!0},g.l(m,g.s4(I,O,r,void 0,X),4);case 4:u=m.N;g.YU(m,3);break;case 2:v=g.Lz(m);if(v instanceof g.rU)throw M="GetOffline network manager error: "+v.message,uj(M,v),Error(M);uj("GetOffline fetch request error",v);throw Error("GetOffline fetch request error");case 3:G=T5(u);if(!u)throw uj("Network request failed"),Error("Network request failed");if(G!==void 0)Ef(G);else if(!u.videos||!u.videos.length)throw uj("No data"),
Error("No data");return m.return(u.videos.map(function(n){return n.offlineVideoData}))}})},x8L=function(c){var I,O,r,u,X,v,M,G;
return g.E(function(m){switch(m.C){case 1:return I=g.vn(),O=xnL(c),r=g.Iu(Ryu),g.yy(m,2),X={vF:!0},g.l(m,g.s4(I,O,r,void 0,X),4);case 4:u=m.N;g.YU(m,3);break;case 2:v=g.Lz(m);if(v instanceof g.rU)throw M="GetOffline network manager error for playlist: "+v.message,uj(M,v),Error(M);uj("GetOffline fetch request error for playlist",v);throw Error("GetOffline fetch request error for playlist");case 3:G=T5(u);if(!u)throw uj("Network request failed for playlist"),Error("Network request failed for playlist");
if(G!==void 0)Ef(G,"playlist");else if(!u.playlists||!u.playlists.length)throw uj("No data for playlist"),Error("No data for playlist");return m.return(u.playlists.map(function(n){return n.offlinePlaylistData}))}})},zys=function(c,I,O,r){var u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk;
return g.E(function(tf){switch(tf.C){case 1:return g.l(tf,cy(),2);case 2:u=tf.N;if(!u)return tf.return([]);X=[];if((v=r)==null?0:v.length){X=r;tf.GF(3);break}return g.l(tf,Qp(u,"mainPlaylistEntity"),4);case 4:X=tf.N;case 3:if(!X.length)return tf.return([]);M=[];G=Date.now()/1E3;m=g.W(X);n=m.next();case 5:if(n.done)return M.length?g.l(tf,Ztb(M),10):tf.return([]);h=n.value;if(!h.downloadState){V=void 0;tf.GF(8);break}return g.l(tf,zK(u,h.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:V=
tf.N;case 8:A=V;N=void 0;L=(J=(N=h)==null?void 0:N.entityMetadata)&&J.nextAutoRefreshIntervalSeconds?Number(J.nextAutoRefreshIntervalSeconds):NaN;U=Number.isNaN(L)?c:L;T=t=void 0;a=((t=A)==null?0:t.lastSyncedTimestampMillis)?Number((T=A)==null?void 0:T.lastSyncedTimestampMillis)/1E3:0;R=K=void 0;d=((K=A)==null?0:K.addedTimestampMillis)?Number((R=A)==null?void 0:R.addedTimestampMillis)/1E3:0;if(O||!J||a+U<=G){uF=[];PF=void 0;if((PF=h.videos)==null?0:PF.length)for(cF=g.W(h.videos),f=cF.next();!f.done;f=
cF.next())Q=f.value,y=JSON.parse(g.Pe(Q).entityId),y.videoId&&uF.push(y.videoId);q="0";J&&(BF=void 0,q=String(Number((BF=J.offlineLastModifiedTimestampSeconds)!=null?BF:0).toFixed()));Ju={playlistId:h.playlistId,videoIds:uF,offlineLastModifiedTimestamp:q,autoSync:I,offlineDateAddedTimestamp:String(d.toFixed())};M.push(Ju)}n=m.next();tf.GF(5);break;case 10:return mk=tf.N,tf.return(mk)}})},QDk=function(){var c,I,O,r,u;
return g.E(function(X){if(X.C==1)return g.l(X,cy(),2);if(X.C!=3)return(c=X.N)?g.l(X,Qp(c,"refresh"),3):X.return(!1);I=X.N;if((O=I[0])==null||!O.refreshTime)return X.return(!1);r=Number(I[0].refreshTime);u=Date.now()/1E3;return X.return(isFinite(r)&&u>=r)})},Icu=function(c,I){var O,r,u;
return g.E(function(X){switch(X.C){case 1:return g.yy(X,2),g.l(X,cda(c,I),4);case 4:return r=X.N,g.l(X,btk(r),5);case 5:O=Fea(r);g.YU(X,3);break;case 2:u=g.Lz(X),uj("getAndProcessSmartDownloadsResponse request or processing error",u);case 3:return X.return(O)}})},OQz=function(c,I,O,r){var u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk;
return g.E(function(tf){switch(tf.C){case 1:return g.l(tf,cy(),2);case 2:u=tf.N;if(!u)return tf.return([]);X=[];if((v=r)==null?0:v.length){X=r;tf.GF(3);break}return g.l(tf,Qp(u,"musicPlaylist"),4);case 4:X=tf.N;case 3:if(!X.length)return tf.return([]);M=[];G=Date.now()/1E3;m=g.W(X);n=m.next();case 5:if(n.done)return M.length?g.l(tf,Ztb(M),10):tf.return([]);h=n.value;V=void 0;N=(A=(V=h)==null?void 0:V.entityMetadata)&&A.nextAutoRefreshIntervalSeconds?Number(A.nextAutoRefreshIntervalSeconds):NaN;J=
Number.isNaN(N)?c:N;U=L=0;t="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!h.downloadMetadata){tf.GF(8);break}return g.l(tf,zK(u,h.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:T=tf.N,K=a=void 0,L=Number((K=(a=T)==null?void 0:a.addedTimestampMillis)!=null?K:"0")/1E3,d=R=void 0,U=Number((d=(R=T)==null?void 0:R.lastModifiedTimestampMillis)!=null?d:"0")/1E3,PF=uF=void 0,t=(PF=(uF=T)==null?void 0:uF.syncState)!=null?PF:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:cF=void 0;if(O||t!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!A||Number((cF=A.lastSyncedTimestampSeconds)!=null?cF:0)+J<=G){f=[];Q=void 0;if((Q=h.tracks)==null?0:Q.length)for(y=g.W(h.tracks),q=y.next();!q.done;q=y.next())BF=q.value,f.push(g.Pe(BF).entityId);Ju={playlistId:h.playlistId,videoIds:f,offlineLastModifiedTimestamp:String(U.toFixed()),autoSync:I,offlineDateAddedTimestamp:String(L.toFixed())};M.push(Ju)}n=m.next();tf.GF(5);break;case 10:return mk=tf.N,tf.return(mk)}})},cda=function(c,I){var O,r,u,X,v,M,G,m,n,h;
return g.E(function(V){switch(V.C){case 1:return O=g.vn(),g.l(V,cy(),2);case 2:r=V.N;if(!r){V.GF(3);break}return g.l(V,r_L(r),4);case 4:u=V.N;case 3:var A=u;X={context:g.zF(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:c},offlineClientState:A,clientStateRequestData:{preferredFormatType:I}}}};v=g.Iu(rdL);g.yy(V,5);G={vF:!0};return g.l(V,g.s4(O,X,v,void 0,G),7);case 7:M=V.N;g.YU(V,6);break;case 5:m=g.Lz(V);if(m instanceof g.rU)throw n=
"DPS network manager error for smart downloads: "+m.message,uj(n,m),Error(n);uj("DPS fetch request error for smart downloads",m);throw Error("DPS fetch request error for smart downloads");case 6:h=T5(M);if(M)h!==void 0&&Ef(h,"smart downloads");else throw uj("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return V.return(M)}})},Xfk=function(c,I){var O,r,u,X,v,M,G,m;
return g.E(function(n){switch(n.C){case 1:return O=g.vn(),r={context:g.zF(),videoPlaybackPositionEntities:c,lastSyncTimestampUsec:I},u=g.Iu(u$L),g.yy(n,2),v={vF:!0},g.l(n,g.s4(O,r,u,void 0,v),4);case 4:X=n.N;g.YU(n,3);break;case 2:M=g.Lz(n);if(M instanceof g.rU)throw G="VPPS network manager error: "+M.message,uj(G,M),Error(G);uj("VPPS fetch request error",M);throw Error("VPPS fetch request error");case 3:m=T5(X);if(X)m!==void 0&&Ef(m,"position sync");else throw uj("Network request failed for position sync"),
Error("Network request failed for position sync");return n.return(X)}})},PML=function(c,I,O){var r,u,X,v,M,G,m,n;
return g.E(function(h){switch(h.C){case 1:r=g.vn();var V=O.refreshData,A=O.isEnqueuedForExpiredStreamUrlRefetch,N=O.Zi,J=O.offlineSourceData,L=O.mediaCapabilities,U={entityKey:c};V&&(U.refreshData=V);A&&(U.isExpiredStreamUrlRefetch=A);N&&(U.downloadParameters=N);J&&(U.offlineSourceData=J);V={context:g.cA(I),signatureTimestamp:20137,videos:[U]};L&&(V.mediaCapabilities=L);u=V;X=g.Iu(vn$);g.yy(h,2);M={vF:!0};return g.l(h,g.s4(r,u,X,void 0,M),4);case 4:v=h.N;g.YU(h,3);break;case 2:G=g.Lz(h);if(G instanceof
g.rU)throw m="GetPDE network manager error: "+G.message,uj(m,G),Error(m);uj("GetPDE fetch request error",G);throw Error("GetPDE fetch request error");case 3:n=T5(v);if(v)n!==void 0&&Ef(n,"PDE");else throw uj("Network request failed for PDE"),Error("Network request failed for PDE");return h.return(v)}})},T5=function(c){var I;
return(I=c.errorMetadata)==null?void 0:I.status},Ef=function(c,I){I=I?" for "+I:"";
if(c===0)throw c="Empty response body"+I,uj(c),Error(c);c="Response with error"+I;uj(c);throw Error(c);},Ztb=function(c){var I,O,r,u,X,v,M,G;
return g.E(function(m){switch(m.C){case 1:return I=g.vn(),O=Zg$(c),r=g.Iu(MZs),g.yy(m,2),X={vF:!0},g.l(m,g.s4(I,O,r,void 0,X),4);case 4:u=m.N;g.YU(m,3);break;case 2:v=g.Lz(m);if(v instanceof g.rU)throw M="offlinePlaylistSyncCheck network manager error: "+v.message,uj(M,v),Error(M);uj("offlinePlaylistSyncCheck fetch request error",v);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:G=T5(u);if(!u)throw uj("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(G!==void 0)Ef(G,"playlist sync");else if(!u.offlinePlaylistSyncCheckDatas||!u.offlinePlaylistSyncCheckDatas.length)throw uj("No data for playlist sync"),Error("No data for playlist sync");return m.return(u.offlinePlaylistSyncCheckDatas.map(function(n){return n.offlinePlaylistSyncCheckData}))}})},bj=function(c){this.C=c},iQO=function(c,I){var O,r,u,X,v,M;
return g.E(function(G){switch(G.C){case 1:O=new Map,r=g.W(I),u=r.next();case 2:if(u.done){G.GF(4);break}X=u.value;v=O;M=v.set;return g.l(G,c.N(X),5);case 5:M.call(v,X,G.N);u=r.next();G.GF(2);break;case 4:return G.return(O)}})},eD=function(c,I,O,r,u,X){I=g.MA(I,O);
r=Object.assign({},X,{priority:r,retryScheduleIntervalsInSeconds:u});return{actionType:c,entityKey:I,actionMetadata:r}},Fr=function(c,I,O,r,u,X){this.status=c;
this.C=I;this.Y=O;this.N=r;this.W=u;this.downloadState=X},GNt=function(c,I,O){this.C=c;
this.uq=I;this.W=O},nns=function(c,I){var O,r,u,X,v,M,G,m,n;
return g.E(function(h){switch(h.C){case 1:return O=I.entityKey,u=(r=g.S(I.actionMetadata,$4))==null?void 0:r.isEnqueuedForExpiredStreamUrlRefetch,g.yy(h,2),X=void 0,g.l(h,j9z(c,I),4);case 4:X=h.N;g.yy(h,5);var V=(V=g.S(I.actionMetadata,$4))?{maximumDownloadQuality:V.maximumDownloadQuality}:void 0;return g.l(h,PML(O,c.uq,{isEnqueuedForExpiredStreamUrlRefetch:u,Zi:V,offlineSourceData:X}),7);case 7:v=h.N;g.YU(h,6,2);break;case 5:return g.Lz(h,2),M=G5(I)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",uj("PDE handleAdd error"),h.return(aP(I,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",M,"DOWNLOAD_STATE_FAILED"));case 6:return g.l(h,mcL(c,v,I),8);case 8:return h.return(aP(I,!0,v.orchestrationActions));case 2:return G=g.Lz(h),m="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",n="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",G instanceof g.Da&&G.type==="QUOTA_EXCEEDED"&&(m="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
n="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),uj("PDE handleAdd error"),h.return(aP(I,!1,void 0,m,n,"DOWNLOAD_STATE_FAILED"))}})},AdY=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF;
return g.E(function(cF){switch(cF.C){case 1:return O=I.entityKey,r=g.Pe(O).entityId,g.l(cF,xk(c.C,{mode:"readonly",Zw:!0},function(f){var Q=Si(f,O,"playbackData"),y=Si(f,g.MA(r,"offlineVideoPolicy"),"offlineVideoPolicy");f=Si(f,g.MA(r,"transfer"),"transfer");return g.U2.all([Q,y,f])}),2);
case 2:u=cF.N;X=g.W(u);v=X.next().value;M=X.next().value;G=X.next().value;m=v;n=M;h=G;if(!m||!n)return cF.return(aP(I,!0));V=[];J=((N=m)==null?0:N.playerResponseJson)?JSON.parse(m.playerResponseJson):null;if(!(h&&J&&c.uq.B("html5_refresh_deprecated_downloads"))){cF.GF(3);break}A=hsk(c,J,h);return g.l(cF,VZu(c,h),4);case 4:V=cF.N;case 3:L={lastPlayerResponseTimestampSeconds:m.playerResponseTimestamp,offlineToken:n.offlineToken,formatIds:V};U={};if((t=h)==null?0:t.maximumDownloadQuality)U.maximumDownloadQuality=
h.maximumDownloadQuality;g.yy(cF,5);T=void 0;return g.l(cF,j9z(c,I),7);case 7:return T=cF.N,g.yy(cF,8),g.l(cF,PML(O,c.uq,{refreshData:L,Zi:U,offlineSourceData:T,mediaCapabilities:A}),10);case 10:a=cF.N;g.YU(cF,9,5);break;case 8:return g.Lz(cF,5),K=G5(I)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",uj("PDE handleRefresh error"),cF.return(aP(I,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",K,
"DOWNLOAD_STATE_FAILED"));case 9:return g.l(cF,mcL(c,a,I),11);case 11:return cF.return(aP(I,!0,a.orchestrationActions));case 5:return R=g.Lz(cF),d="PDE handleRefresh error",R instanceof Error&&(d="PDE handleRefresh error: "+R.message),uF="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",PF="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",R instanceof g.Da&&R.type==="QUOTA_EXCEEDED"&&(uF="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",PF="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
uj(d),cF.return(aP(I,!1,void 0,uF,PF,"DOWNLOAD_STATE_FAILED"))}})},j9z=function(c,I){var O,r,u,X;
return g.E(function(v){if(v.C==1)return O=g.Pe(I.entityKey).entityId,r=g.MA(O,"videoDownloadContextEntity"),g.l(v,zK(c.C,r,"videoDownloadContextEntity"),2);u=v.N;return(X=u)!=null&&X.offlineModeType?v.return({offlineModeType:u.offlineModeType}):v.return(void 0)})},mcL=function(c,I,O){var r,u,X,v,M;
return g.E(function(G){if(G.C==1){if(!I.frameworkUpdates||!g.S(I.frameworkUpdates,pI))return G.return();if(!(g.S(I.frameworkUpdates,pI).mutations&&g.S(I.frameworkUpdates,pI).mutations.length>0&&g.S(I.frameworkUpdates,pI).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return G.GF(2);r=g.Pe(g.S(I.frameworkUpdates,pI).mutations[0].entityKey).entityId;return g.l(G,Uf(c.C,r),3)}if(G.C!=2){u=G.N;X=g.S(O.actionMetadata,$4);if(M=(v=X)==null?void 0:v.playlistId)u.playlistId=M;u.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.wp(c.uq)?g.l(G,LI(r,c.C,O,c.W,u),2):g.kC(c.uq)?g.l(G,CI(r,c.C,O,c.W),2):G.GF(2)}return g.l(G,BHt(g.S(I.frameworkUpdates,pI)),0)})},aP=function(c,I,O,r,u,X){return new Fr(I?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",G5(c),O,r,u,X)},hsk=function(c,I,O){I=LeY(c.uq,O.cotn,I);
O=g.uG(I);return g.teF(I,O,c.uq)},VZu=function(c,I){var O,r,u,X,v,M,G,m,n,h,V;
return g.E(function(A){if(A.C==1)return O=[],g.l(A,xk(c.C,{mode:"readonly",Zw:!0},function(N){var J=[],L=I.offlineVideoStreams;if(L){L=g.W(L);for(var U=L.next();!U.done;U=L.next())J.push(Si(N,U.value,"offlineVideoStreams"))}return g.U2.all(J)}),2);
if(r=A.N)for(u=g.W(r),X=u.next();!X.done;X=u.next())if(v=X.value,M=void 0,(M=v)==null?0:M.streamsProgress)for(G=v.streamsProgress,m=0;m<G.length;m++)n=G[m],h=JSON.parse(n.formatStreamBytes),V={itag:h.itag,lmt:h.lastModified,xtags:h.xtags},O.push(V);return A.return(O)})},NFY=function(c,I){this.C=c;
this.uq=I},Dcs=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A;
return g.E(function(N){switch(N.C){case 1:return O=G5(I),g.l(N,Qp(c.C,"videoPlaybackPositionEntity"),2);case 2:r=N.N;if(r.length===0)return N.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));g.yy(N,3);return g.l(N,kk.getInstance(),5);case 5:u=N.N;if(!u)throw Error("prefStorage is undefined");return g.l(N,u.get("psi"),6);case 6:return X=N.N,G=(M=(v=X)==null?void 0:v.a6)!=null?M:"0",g.l(N,Xfk(r,G),7);case 7:return m=N.N,n={isPaused:m.watchHistoryPaused,a6:m.syncTimestampUsec},g.l(N,u.set("psi",
n),8);case 8:if(n.isPaused){N.GF(9);break}h=g.S(m.frameworkUpdates,pI);if(!m.frameworkUpdates||!h){N.GF(9);break}return g.l(N,BHt(h),9);case 9:g.YU(N,4);break;case 3:return V=g.Lz(N),A="PPE handleRefresh error: "+(V instanceof Error?V.message:"unknown error"),uj(A),N.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return N.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O))}})},ydX=function(c,I){var O,r,u,X,v,M,G,m;
return g.E(function(n){switch(n.C){case 1:return O=G5(I),r=g.Pe(I.entityKey).entityId,g.yy(n,2),g.l(n,kk.getInstance(),4);case 4:u=n.N;if(!u)throw Error("prefStorage is undefined");return g.l(n,u.get("psi"),5);case 5:X=n.N;v=g.S(I.actionMetadata,Wjb);if(((M=X)==null?void 0:M.isPaused)!==!1||(G=v)==null||!G.lastPlaybackPositionSeconds){n.GF(6);break}m={key:g.MA(r,"videoPlaybackPositionEntity"),videoId:r,lastPlaybackPositionSeconds:v.lastPlaybackPositionSeconds};return g.l(n,Z$(c.C,m,"videoPlaybackPositionEntity"),
6);case 6:g.YU(n,3);break;case 2:return g.Lz(n),n.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return n.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O))}})},JdX=function(c,I){var O,r,u;
return g.E(function(X){switch(X.C){case 1:O=G5(I);g.yy(X,2);r=g.Pe(I.entityKey).entityId;if(r==="!*$_ALL_ENTITIES_!*$")return g.l(X,$nX(c.C),5);u=g.MA(r,"videoPlaybackPositionEntity");return g.l(X,Fva(c.C,u),5);case 5:g.YU(X,3);break;case 2:return g.Lz(X),X.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return X.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O))}})},Y1Y=function(c,I){this.api=c;
this.C=I;this.logger=new g.QQ("woffle");this.N=!1;this.x5={Q5:this.Q5};this.logger.debug("Initialized OfflineMediaManager")},LjY=function(c){return g.E(function(I){return I.return(R8z(c))})},pfz=function(c){var I;
return g.E(function(O){if(O.C==1)return g.l(O,g.zAU(c),2);I=O.N;return O.return(I.filter(function(r){return!!r.url}).map(function(r){return r.url}))})},oP=function(c,I){var O=g.Us(I);
if(O===1||O===0)return Promise.resolve();(O=Ucu(c,I))&&O.stopVideo();c.W=0;return LjY(I)},k4=function(c,I,O,r){O=O===void 0?!1:O;
r=r===void 0?!0:r;var u=typeof I==="string"?I:I.videoDetails.videoId;g.Us(u)===2&&((I=Ucu(c,u))?I.stopVideo():c.logger.info(function(){return"Corresponding player for "+u+" not found. Pausing anyway"}),g.Cd(u,2),c.W=2,O?CMa(c.C):r&&tZ$(c.C))},Ucu=function(c,I){var O;
return((O=c.player)==null?void 0:O.getVideoData().videoId)===I?c.player:null},HQk=function(c,I,O){I.getPlayerResponse();
g.Cd(I.videoId,2);c.W=2;c.N=!1;var r;(r=c.player)==null||r.dispose();c.player=c.api.BR(I);I={};c.player.Gb((I.localmediachange=c.gq,I.signatureexpired=c.K7,I.statechange=c.SzB,I),c);var u=c.Q5(O);c.player.Wj(g.cz(u,u,!0,"m"),!1);c.logger.debug(function(){return"Starting headless playback with quality: "+u});
c.player.dL(!1)},lcL=function(c,I){this.C=c;
this.uq=I},EnO=function(c,I){var O,r;
return g.E(function(u){switch(u.C){case 1:return O=G5(I),g.l(u,zK(c.C,I.entityKey,"transfer"),2);case 2:if(r=u.N)return u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));g.yy(u,3);return g.l(u,TFL(c,I),5);case 5:g.YU(u,4);break;case 3:return g.Lz(u),u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O))}})},bQs=function(c,I){var O,r;
return g.E(function(u){switch(u.C){case 1:return O=G5(I),g.l(u,zK(c.C,I.entityKey,"transfer"),2);case 2:r=u.N;if(!r||r.transferState!=="TRANSFER_STATE_COMPLETE")return u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));g.yy(u,3);return g.l(u,TFL(c,I,!0),5);case 5:g.YU(u,4);break;case 3:return g.Lz(u),u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O))}})},esL=function(c,I){var O,r,u,X,v,M,G,m,n,h;
return g.E(function(V){switch(V.C){case 1:return O=G5(I),r=g.Pe(I.entityKey).entityId,g.l(V,xk(c.C,{mode:"readonly",Zw:!0},function(A){var N=Si(A,I.entityKey,"transfer");A=Si(A,g.MA(r,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.U2.all([N,A])}),2);
case 2:u=V.N;X=g.W(u);v=X.next().value;M=X.next().value;G=v;m=M;if(!G||G.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return V.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));g.yy(V,3);G.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.l(V,Z$(c.C,G,"transfer"),5);case 5:n=g.Pe(G.key).entityId;ij({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},{videoId:n,Nb:G,offlineModeType:(h=m)==null?void 0:h.offlineModeType});g.YU(V,
4);break;case 3:return g.Lz(V),V.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return V.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O))}})},TFL=function(c,I,O){O=O===void 0?!1:O;
var r,u,X,v,M,G,m,n,h,V,A,N,J,L,U;return g.E(function(t){switch(t.C){case 1:return r=g.S(I.actionMetadata,FjL),u=g.Pe(I.entityKey).entityId,X=g.MA(u,"downloadStatusEntity"),g.l(t,xk(c.C,{mode:"readonly",Zw:!0},function(T){var a=Si(T,X,"downloadStatusEntity");T=Si(T,g.MA(u,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.U2.all([a,T])}),2);
case 2:return v=t.N,M=g.W(v),G=M.next().value,m=M.next().value,n=G,h=m,V="TRANSFER_STATE_TRANSFER_IN_QUEUE",((A=n)==null?void 0:A.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(V="TRANSFER_STATE_PAUSED_BY_USER"),L={key:I.entityKey,transferState:V,cotn:g.pR(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(N=r)==null?void 0:N.maximumDownloadQuality,preferredAudioTrack:(J=r)==null?void 0:J.preferredAudioTrack,transferRetryCount:0,isRefresh:O,hasLoggedFirstStarted:!1},g.l(t,xk(c.C,
{mode:"readwrite",Zw:!0},function(T){var a=[];O&&a.push(w0(T,g.MA(u,"offlineVideoStreams")));a.push(qu(T,L,"transfer"));return g.U2.all(a)}),3);
case 3:if(!O){t.GF(4);break}return g.l(t,LjY(u),4);case 4:ij({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",statusType:"ADDED_TO_QUEUE"},{videoId:u,Nb:L,offlineModeType:(U=h)==null?void 0:U.offlineModeType}),g.WF(t)}})},acz=function(c,I,O,r){if(!c.action.entityKey)throw Error("entityKey is missing.");
var u=g.Pe(c.action.entityKey);u={entityType:u.r4,entityId:u.entityId,offlineOrchestrationActionType:c.action.actionType,orchestrationAction:{orchestrationActionId:c.actionId}};I&&(u.offlineOrchestrationActionResult=I.status,u.isRetryable=O?!1:I.C,I.W&&(u.offlineOrchestrationFailureReason=$ca(I.W,u.isRetryable)));var X,v;if((X=c.action.actionMetadata)==null?0:(v=X.offlineLoggingData)==null?0:v.offlineModeType)u.offlineModeType=c.action.actionMetadata.offlineLoggingData.offlineModeType;r&&(u.additionalOrchestrationActions=
r.map(function(M){return{orchestrationActionId:M.actionId}}));
return u},$ca=function(c,I){return c!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||I?c==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&I?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":c:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},onL=function(c,I){var O={offlineOrchestrationContext:acz(c)};
I=IT7(I,O);Ots(c_b(),I,c.rootActionId)},kNL=function(c,I,O,r){r=r===void 0?[]:r;
I={offlineOrchestrationContext:acz(c,I,O,r)};I=IT7(3,I);Ots(c_b(),I,c.rootActionId)},Kjs=function(){this.actions=[]},BF7=function(c,I){I=g.W(I);
for(var O=I.next();!O.done;O=I.next())O=O.value,onL(O,1),c.actions.push(O);c.actions.sort(c.C)},S1$=function(c,I){if(I)for(var O=0;O<c.actions.length;O++)if(I==="!*$_ALL_ENTITIES_!*$"&&c.actions[O].actionId!==I||I!=="!*$_ALL_ENTITIES_!*$"&&c.actions[O].rootActionId===I&&c.actions[O].actionId!==I)c.actions.splice(O,1),O--},gnb=function(c,I){c=g.W(c.actions);
for(var O=c.next();!O.done;O=c.next())if(O.value.actionId===I)return!0;return!1},KI=function(c,I,O,r,u){g.k.call(this);
var X=this;this.N=c;this.x$=I;this.NF=O;this.V=r;this.uq=u;this.C=new Kjs;this.G=new g.xu;this.W=new g.IW(function(){X.retry()});
this.K=NaN;this.L=!1;this.x5={Ab1:function(){return X.C},
ES:function(){return X.G},
Qfh:function(){return X.W},
retry:function(){return X.retry()}};
g.B(this,this.W);this.j=this.N.observe(this.nV.bind(this))},wfO=function(c,I,O,r,u){var X;
return g.E(function(v){if(v.C==1)return X=new KI(c,I,O,r,u),g.l(v,fc7(X),2);q1Y(X);return v.return(X)})},q1Y=function(c){var I=c.C.actions[0];
return c.Y?((I==null?void 0:I.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&c.Y[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(c.L=!0),Promise.resolve()):dc7(c)},dc7=function(c){var I,O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U;
return g.E(function(t){switch(t.C){case 1:if(c.Y)throw Error("Already processing an action");if(c.lq())return t.return();I=c.C.actions.shift();VQb(c.NF,!I);if(I===void 0)return t.return();I.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&I.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&S1$(c.C,I.actionId);O="";I.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&I.rootActionId===I.actionId&&(O=I.actionId);r=[I];c.Y=r;if(u=c.x$[I.entityType]){t.GF(2);break}c.Y=
void 0;return g.l(t,dc7(c),3);case 3:return t.return();case 2:X=g.W(r);for(v=X.next();!v.done;v=X.next())M=v.value,onL(M,2);g.yy(t,4,5);return g.l(t,iQO(u,r.map(function(T){return T.action})),7);
case 7:G=t.N,m=g.W(r),n=m.next();case 8:if(n.done){t.GF(10);break}h=n.value;V=G.get(h.action);return g.l(t,Rsa(c,h,V),9);case 9:n=m.next();t.GF(8);break;case 10:S1$(c.C,O);case 5:g.pz(t);c.Y=void 0;g.Ud(t,6);break;case 4:return A=g.Lz(t),uj("Orchestration error",A),g.yy(t,12),g.l(t,s9z(c,r),14);case 14:g.YU(t,5);break;case 12:N=g.Lz(t);uj("Orchestration retry error",N);J=g.W(r);for(L=J.next();!L.done;L=J.next())U=L.value,U.retryScheduleIndex<3&&BF7(c.C,[U]);t.GF(5);break;case 6:return g.l(t,dc7(c),
0)}})},Rsa=function(c,I,O){var r,u,X,v,M,G,m,n,h,V,A,N;
return g.E(function(J){switch(J.C){case 1:r=I.retryScheduleIndex+2===3;if(O.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){J.GF(2);break}if(O.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){J.GF(0);break}kNL(I,O,r);if(O.C&&I.retryScheduleIndex+1<3)return g.l(J,s9z(c,[I]),0);X=((u=O)==null?0:u.N)?O.N:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";v={entityKey:I.action.entityKey,failureReason:X};M=void 0;g.wp(c.uq)?M="mainVideoDownloadStateEntity":g.kC(c.uq)&&(M="musicTrackDownloadMetadataEntity");
if(!M||!O.downloadState){J.GF(7);break}G=g.Pe(I.action.entityKey).entityId;return g.l(J,hn(G,M,c.N,O.downloadState),7);case 7:vy(c.V,v);if(O.downloadState==="DOWNLOAD_STATE_FAILED"&&c.uq.B("html5_auto_retry_failed_pde_actions")){J.GF(0);break}uj("Orchestration result is not retryable, deleting action");return g.l(J,Fva(c.N,yc(I).key),0);case 2:m=void 0;try{m=(n=O.Y)==null?void 0:n.map(function(L){return c.createAction(L,I)})}catch(L){return kNL(I,O,r),h={entityKey:I.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},vy(c.V,h),uj("Orchestration subactions creation error",L),J.return()}kNL(I,O,r,m);if(!m){J.GF(12);break}V=m.map(function(L){return yc(L)});
A=0;case 13:if(!(A<m.length)||c.L){J.GF(15);break}return g.l(J,xk(c.N,{mode:"readwrite",Zw:!0},function(L){var U=[];U.push(ph7(L,V.slice(A,A+10),"offlineOrchestrationActionWrapperEntity"));return g.U2.all(U)}),16);
case 16:A+=10;J.GF(13);break;case 15:if(c.L)return c.L=!1,J.return();case 12:return N=yc(I),g.l(J,Fva(c.N,N.key),17);case 17:onL(I,4),g.WF(J)}})},Q9X=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A;
return g.E(function(N){O=[];r=Infinity;u=4E3;X=g.W(I);for(v=X.next();!v.done;v=X.next())M=v.value,G=Number(M.enqueueTimeSec),m=xcX(G),n=M.retryScheduleIndex,h=n!=null&&n>0,m>0&&h?(r=Math.min(r,G),u=Math.min(m,u)):O.push(M);isFinite(r)&&(!c.W.isActive()||r<c.K)&&(c.K=r,c.W.start(u));c.G.Vf()||(V=O.length,O=O.filter(function(J){var L;J=((L=J.actionProto)==null?void 0:L.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!ZQ7.includes(J)}),A=O.length<V,!c.W.isActive()&&A&&c.W.start(1));
O.length>0&&zss(c,O);return g.l(N,q1Y(c),0)})},IQs=function(c){var I,O,r,u,X,v,M;
return g.E(function(G){if(G.C==1)return g.l(G,cFb(c),2);I=G.N;O=[];r=g.W(I);for(u=r.next();!u.done;u=r.next())X=u.value,v=g.Pe(X.key),M=v.entityId,gnb(c.C,M)||O.push(X);return g.l(G,Q9X(c,O),0)})},xcX=function(c){c=c*1E3-Date.now();
return c>4E3?4E3:c},s9z=function(c,I){var O,r,u;
return g.E(function(X){O=g.W(I);for(r=O.next();!r.done;r=O.next()){u=r.value;var v=void 0,M=void 0,G=((M=u.action)==null?void 0:(v=M.actionMetadata)==null?void 0:v.retryScheduleIntervalsInSeconds)||[1,2,4];v=1;u.retryScheduleIndex<G.length&&(v=G[u.retryScheduleIndex]);u.C=v*1E3+Date.now();u.retryScheduleIndex++}return g.l(X,Oqa(c,I),0)})},fc7=function(c){var I;
return g.E(function(O){if(O.C==1)return g.l(O,Qp(c.N,"offlineOrchestrationActionWrapperEntity"),2);I=O.N;return g.l(O,Q9X(c,I),0)})},zss=function(c,I){I.length!==0&&I.forEach(function(O){O=Wy(O);
O.retryScheduleIndex<3&&BF7(c.C,[O])})},cFb=function(c,I){var O;
return g.E(function(r){if(r.C==1)return g.l(r,Qp(c.N,"offlineOrchestrationActionWrapperEntity",I),2);O=r.N;return r.return(O.filter(Ses))})},Oqa=function(c,I){if(I.length===0)return Promise.resolve([]);
I=I.map(function(O){return yc(O)});
return e8k(c.N,I)},rF7=function(c){this.Ji=c;
this.C=void 0},u6k=function(c,I){var O,r,u,X;
return g.E(function(v){O=I.videoId;r=!0;if(I.captionTracks.length)u=YtL(I),c.C=new g.TT(c.Ji,I,u);else if(I.aH)X=g.MSi(I),c.C=new g.bE(c.Ji,I.aH,O,X,I.S3,I.eventId),r=I.S3;else return v.return();return v.return(new Promise(function(M){var G;(G=c.C)==null||G.Jk({t0:function(){return g.E(function(m){if(m.C==1)return g.l(m,c.t0(O,r),2);M();g.WF(m)})},
zK:function(){}})}))})},XtY=function(c){var I;
return g.E(function(O){if(O.C==1)return g.l(O,dnk(c),2);I=O.N;return O.return(!!I&&I.length>0)})},By=function(c){g.k.call(this);
this.C=c;this.N=this.C.observe(this.W.bind(this))},vF$=function(c,I){var O,r,u,X,v,M,G;
return g.E(function(m){switch(m.C){case 1:if(I.length===0)return m.return([]);O=I.map(function(n){return g.MA(n,"transfer")});
return g.l(m,Qp(c.C,"transfer",O),2);case 2:r=m.N;u=r.filter(Ses).map(function(n){return g.Pe(n.key).entityId});
X=I.filter(function(n){return u.indexOf(n)===-1});
if(X.length===0)return m.return([]);v=g.W(X);M=v.next();case 3:if(M.done){m.GF(5);break}G=M.value;return g.l(m,LjY(G),4);case 4:M=v.next();m.GF(3);break;case 5:return m.return(X)}})},iq7=function(c,I,O,r,u,X){var v,M,G;
return g.E(function(m){v="STREAM_TYPE_UNKNOWN";O.video&&O.audio?(v="STREAM_TYPE_AUDIO_AND_VIDEO",uj("unexpected stream type")):O.video&&!O.audio?v="STREAM_TYPE_VIDEO":!O.video&&O.audio&&(v="STREAM_TYPE_AUDIO");M=g.MA(I,"offlineVideoStreams");G={numBytesDownloaded:u.toFixed(),numTotalBytes:X.toFixed(),streamType:v,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(r),itag:v==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(O.itag):void 0};return g.l(m,xk(c,{mode:"readwrite",Zw:!0},
function(n){var h=Si(n,M,"offlineVideoStreams"),V=Si(n,g.MA(I,"transfer"),"transfer");return g.U2.all([h,V]).then(function(A){A=g.W(A);var N=A.next().value;A=A.next().value;if(!A)return w0(n,M).then(function(){});
var J=P$z(N);N=M4k(N,r,G,M);var L=qu(n,N,"offlineVideoStreams");P$z(N)>J&&(A.lastProgressTimeMs=Date.now().toString());J=[L];A.offlineVideoStreams||(A.offlineVideoStreams=[]);A.offlineVideoStreams.indexOf(M)===-1&&(A.offlineVideoStreams.push(M),J.push(qu(n,A,"transfer")));return g.U2.all(J)})}),0)})},Gub=function(c,I){var O,r,u,X,v;
return g.E(function(M){if(M.C==1)return O=g.MA(I,"offlineVideoStreams"),g.l(M,zK(c,O,"offlineVideoStreams"),2);r=M.N;if(!r||!r.streamsProgress)return M.return();u=g.W(r.streamsProgress);for(X=u.next();!X.done;X=u.next())v=X.value,v.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",v.numTotalBytes!==v.numBytesDownloaded&&(v.numBytesDownloaded=v.numTotalBytes);return g.l(M,Z$(c,r,"offlineVideoStreams"),0)})},M4k=function(c,I,O,r){if(c&&c.streamsProgress){r=c;
a:{I=I.itag+";"+I.xtags;for(var u=c.streamsProgress,X=0;X<u.length;X++){var v=JSON.parse(u[X].formatStreamBytes);if(v.itag+";"+v.xtags===I){u[X]=O;O=u;break a}}u.push(O);O=u}r.streamsProgress=O}else c={key:r,streamsProgress:[O]};return c},P$z=function(c){if(c==null?0:c.streamsProgress){var I=0;
c=c.streamsProgress;for(var O=0;O<c.length;O++){var r=c[O];isNaN(Number(r.numBytesDownloaded))?uj("stream progress bytes number invalid"):I+=Number(r.numBytesDownloaded)}return I}return 0},j6a=function(c,I,O,r){g.k.call(this);
var u=this;this.N=c;this.api=I;this.bq=O;this.nV=r;this.G=new g.xu;this.Y=new g.IW(function(){u.C&&u.C.transferState==="TRANSFER_STATE_TRANSFERRING"&&u.G.Vf()&&((u.C.transferRetryCount||0)<3?k4(u.V,u.L,!1,!1):oP(u.V,u.L.videoDetails.videoId),u.hO("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.NF=this.H0=0;this.j=this.K=!1;this.KV=g.nL(this.api.J().experiments,"html5_transfer_processing_logs_interval");this.Zh=new g.$R(this);this.x5={IyH:function(){return u.Y},
ejH:function(){return u.nV},
ES:function(){return u.G}};
this.x$=this.N.observe(this.IG.bind(this));this.V=new Y1Y(I,this);this.zF=new rF7(I);this.Sf=new By(this.N);this.LV=this.G.listen("publicytnetworkstatus-online",this.eO.bind(this));this.B0=this.G.listen("publicytnetworkstatus-offline",this.ZDB.bind(this));this.j=this.api.J().B("html5_less_transfer_processing_logs");g.B(this,this.Zh);this.Zh.Z(I,"offlinetransferpause",this.REi);g.wp(this.api.J())?this.W="mainVideoDownloadStateEntity":g.kC(this.api.J())&&(this.W="musicTrackDownloadMetadataEntity")},
mQk=function(c){return g.E(function(I){if(I.C==1)I=g.l(I,qes(),2);
else{var O=c.Sf;var r=g.pd();r=Object.keys(r);O=vF$(O,r);I=g.l(I,O,0)}return I})},gD=function(c,I){I=I===void 0?!1:I;
var O;return g.E(function(r){if(r.C==1){if(c.C)throw Error("Already downloading a video");c.NF=0;c.K=!1;return g.l(r,nFk(c),2)}return r.C!=4?(O=r.N,A_L(c.bq,!O),O&&c.G.Vf()?I?g.l(r,new Promise(function(u){g.DY(u,1E3)}),4):r.GF(4):(!O&&c.C&&SD(c),r.GF(0))):g.l(r,h_a(c,O),0)})},V4s=function(c){return g.E(function(I){if(I.C==1)return c.L?g.l(I,oP(c.V,c.L.videoDetails.videoId),3):I.GF(0);
SD(c);g.WF(I)})},AFb=function(c,I){var O,r,u;
return g.E(function(X){switch(X.C){case 1:return g.yy(X,2),(O=!!I.captionTracks.length||!!I.aH)?g.l(X,XtY(I.videoId),4):X.return();case 4:return(r=X.N)?X.return():g.l(X,u6k(c.zF,I),5);case 5:g.YU(X,0);break;case 2:u=g.Lz(X),uj("Caption downloading error",u,I.cotn),g.WF(X)}})},h_a=function(c,I){var O,r,u,X,v,M;
return g.E(function(G){switch(G.C){case 1:if(c.K)return G.return();c.K=!0;c.C=I;O=g.Pe(c.C.key);r=O.entityId;u=void 0;if(c.C.transferState==="TRANSFER_STATE_TRANSFERRING")return g.l(G,fI(c,r),7);if(c.C.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||c.C.transferRetryCount||c.C.hasLoggedFirstStarted){G.GF(3);break}return g.l(G,fI(c,r),5);case 5:return u=G.N,c.C.hasLoggedFirstStarted=!0,g.l(G,NC7(c),6);case 6:NJu({videoId:r,Nb:c.C,offlineModeType:u},void 0,void 0,!0);G.GF(3);break;case 7:u=G.N,
ij({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:r,Nb:c.C,offlineModeType:u});case 3:return g.l(G,DQ$(c),8);case 8:return X=null,g.yy(G,9),g.l(G,W8L(c,I),11);case 11:X=G.N;c.L=X;g.YU(G,10);break;case 9:return v=g.Lz(G),uj("error getting player response",v,I.cotn),g.l(G,c.hO("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return G.return();case 10:return M=LeY(c.api.J(),I.cotn,X),g.l(G,AFb(c,M),13);case 13:return g.l(G,pfz(M.videoId),
14);case 14:M.JP=G.N,HQk(c.V,M,I.maximumDownloadQuality),c.Y.start(108E5),g.WF(G)}})},nFk=function(c){var I,O;
return g.E(function(r){if(r.C==1)return g.l(r,Qp(c.N,"transfer"),2);I=r.N;O=I.filter(yFb).sort(JFb);return O.length===0?r.return():r.return(O[0])})},DQ$=function(c){var I,O,r;
return g.E(function(u){if(u.C==1){if(!c.C)return q7(c,"onTransferStart"),u.return();c.Y.start(108E5);return g.l(u,wD(c,"TRANSFER_STATE_TRANSFERRING"),2)}I=c.C;return(r=((O=I)==null?0:O.key)?g.Pe(I.key).entityId:"")&&c.W?g.l(u,hn(r,c.W,c.N,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):u.GF(0)})},CMa=function(c){var I,O,r,u;
g.E(function(X){switch(X.C){case 1:if(!c.C){q7(c,"onTransferPausedByUser");X.GF(2);break}I=c.C;c.Y.stop();return g.l(X,wD(c,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:r=((O=I)==null?0:O.key)?g.Pe(I.key).entityId:"";if(!r||!c.W){X.GF(4);break}return g.l(X,hn(r,c.W,c.N,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.l(X,fI(c,r),6);case 6:u=X.N,D8O({videoId:r,Nb:I,offlineModeType:u});case 2:SD(c),gD(c),g.WF(X)}})},tZ$=function(c){var I,O,r;
g.E(function(u){if(u.C==1){if(!c.C)return q7(c,"onTransferPausedByNetwork"),u.return();c.Y.stop();return g.l(u,wD(c,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(u.C!=3)return I=c.C,(r=((O=I)==null?0:O.key)?g.Pe(I.key).entityId:"")&&c.W?g.l(u,hn(r,c.W,c.N,"DOWNLOAD_STATE_PAUSED"),3):u.GF(3);SD(c);g.WF(u)})},Y6O=function(c){var I,O,r,u,X;
g.E(function(v){switch(v.C){case 1:if(!c.C)return q7(c,"onTransferComplete"),v.return();I=c.C;c.Y.stop();if(!I||!c.L){v.GF(2);break}O=LeY(c.api.J(),I.cotn,c.L);return g.l(v,AFb(c,O),2);case 2:return g.l(v,wD(c,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:u=((r=I)==null?0:r.key)?g.Pe(I.key).entityId:"";if(!u||!c.W){v.GF(5);break}return g.l(v,hn(u,c.W,c.N,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.l(v,Gub(c.N,u),7);case 7:return g.l(v,fI(c,u),8);case 8:X=v.N,ij({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:u,Nb:I,offlineModeType:X}),SD(c),gD(c),g.WF(v)}})},L8O=function(c,I,O){var r,u;
g.E(function(X){switch(X.C){case 1:if(!c.C)return q7(c,"onTransferProgress: "+I),X.return();if(c.C.transferState==="TRANSFER_STATE_TRANSFERRING"){X.GF(2);break}return g.l(X,DQ$(c),2);case 2:r=Date.now();if(!(r-c.H0>1E3)){X.GF(4);break}c.H0=r;return g.l(X,iq7(c.N,O.videoId,O.N,O.D1,O.bytesDownloaded,O.C),5);case 5:if(c.j&&!(c.j&&r-c.NF>c.KV)){X.GF(4);break}c.NF=r;return g.l(X,fI(c,I),7);case 7:u=X.N,NJu({videoId:I,Nb:c.C,offlineModeType:u},O.bytesDownloaded,O.C);case 4:c.Y.start(108E5),g.WF(X)}})},
ptO=function(c){var I=(c.C.transferRetryCount||0)<3;
I&&(c=c.C,c.transferRetryCount=(c.transferRetryCount||0)+1);return I},UQs=function(c,I){I=I===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":I;
var O,r,u,X;return g.E(function(v){if(v.C==1)return c.C||q7(c,"setTransferToFailed: "+I),O="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",I==="TRANSFER_FAILURE_REASON_NETWORK"?O="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":I==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(O="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.l(v,wD(c,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",I),2);if(v.C!=3)return vy(c.nV,{entityKey:(r=c.C)==null?void 0:r.key,failureReason:O}),
u=c.C?g.Pe(c.C.key).entityId:"",g.l(v,fI(c,u),3);X=v.N;var M={videoId:u,Nb:c.C,offlineModeType:X},G=I,m={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};G&&(m.transferFailureReason=G,m.failureReason=Wes(G));ij(m,M);g.WF(v)})},wD=function(c,I,O,r){var u;
return g.E(function(X){if(X.C==1){if(!c.C)return q7(c,"saveTransferState: "+I),X.return();c.C.transferState=I;c.C.failureReason=r;g.yy(X,2);return g.l(X,NC7(c,function(v){return O?g0(v,"offlineVideoStreams",c.C.offlineVideoStreams).then(function(M){for(var G=g.W(M),m=G.next();!m.done;m=G.next())if((m=m.value)&&m.streamsProgress){m=g.W(m.streamsProgress);for(var n=m.next();!n.done;n=m.next())n.value.streamState=O}return ph7(v,M.filter(function(h){return!!h}),"offlineVideoStreams")}):g.U2.resolve(void 0)}),
4)}if(X.C!=2)return g.YU(X,0);
u=g.Lz(X);return u instanceof g.Da&&u.type==="QUOTA_EXCEEDED"?g.l(X,c.hO("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):X.GF(0)})},NC7=function(c,I){var O;
return g.E(function(r){if(!c.C)return r.return();O=c.C;return g.l(r,xk(c.N,{mode:"readwrite",Zw:!0},function(u){var X=[qu(u,O,"transfer")];I&&X.push(I(u));return g.U2.all(X)}),0)})},SD=function(c){c.C=void 0;
c.L=void 0;c.Y.stop()},W8L=function(c,I){var O,r,u,X,v;
return g.E(function(M){if(M.C==1)return O=g.Pe(I.key),r=O.entityId,u=g.MA(r,"playbackData"),g.l(M,zK(c.N,u,"playbackData"),2);X=M.N;if((v=X)==null?0:v.playerResponseJson)return M.return(JSON.parse(X.playerResponseJson));throw Error("No PlayerResponse found");})},q7=function(c,I){c.api.fV("woffle",{mcte:I});
uj("missing current transfer entity.")},fI=function(c,I){var O,r,u;
return g.E(function(X){if(X.C==1)return g.l(X,zK(c.N,g.MA(I,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);O=X.N;return X.return((u=(r=O)==null?void 0:r.offlineModeType)!=null?u:void 0)})},yFb=function(c){return C$k[c.transferState]!==void 0},JFb=function(c,I){var O=C$k[c.transferState],r=C$k[I.transferState];
return O!==r?O-r:Number(c.enqueuedTimestampMs)-Number(I.enqueuedTimestampMs)},dD=function(c,I){var O=this;
this.uq=c;this.api=I;this.G=new g.xu;this.L=new g.Am;this.x5={tW:function(){return O.W.x5.tW()},
ES:function(){return O.G},
sf$:function(){return O.W},
xM:function(){return O.xM()},
Xa:function(){return O.Xa()},
i4:function(){return O.i4()},
Np:function(){return O.Np()},
C1:function(){return O.C1()},
oB:function(r){return O.oB(r)}};
this.W=new m87(function(){return t4$(O)},function(){O.i4()},this.api.mA(),this.api.B.bind(this.api));
this.C=new Xr(this.api);ntO(this.W)},t4$=function(c){return g.E(function(I){c.api.XV("onOrchestrationBecameLeader");
return g.l(I,c.Xa(),0)})},lQt=function(c){var I,O;
return g.E(function(r){if(r.C==1)return g.l(r,cy(),2);if(r.C!=3){I=r.N;if(!I)return uj("PES is undefined"),r.return();c.N=new j6a(I,c.api,c.W,c.C);O=c.yS(I);return g.l(r,wfO(I,O,c.W,c.C,c.uq),3)}c.V=r.N;return g.l(r,Hqt(c),0)})},Hqt=function(c){var I;
return g.E(function(O){switch(O.C){case 1:if(!c.N)return uj("transferManager is undefined"),O.return();if(c.N.C){O.GF(2);break}return g.l(O,gD(c.N),2);case 2:if(!c.uq.B("woffle_enable_main_downloads_library")){O.GF(4);break}return g.l(O,c.N9(),4);case 4:if(!c.uq.B("html5_offline_playback_position_sync")){O.GF(6);break}return g.l(O,c.SF(),7);case 7:return g.l(O,c.oB(864E5),6);case 6:return g.l(O,c.refreshAllStaleEntities(43200,!0),9);case 9:return g.l(O,c.aD(),10);case 10:if(!c.uq.B("html5_retry_downloads_for_expiration")){O.GF(11);
break}return g.l(O,c.C1(),11);case 11:return c.K=g.WJ(function(){c.refreshAllStaleEntities(43200,!0);c.aD()},9E5),g.ck(g.O2(),function(){return c.Np()}),g.l(O,cy(),13);
case 13:return I=O.N,g.l(O,jDO(I),14);case 14:hyu(c.W),g.WF(O)}})},TCL=function(){var c,I,O,r,u,X;
return g.E(function(v){switch(v.C){case 1:return g.l(v,cy(),2);case 2:c=v.N;if(!c)return v.return([]);I=Date.now()/1E3;return g.l(v,Qp(c,"offlineVideoPolicy"),3);case 3:O=v.N,r=g.W(O),u=r.next();case 4:if(u.done){v.GF(6);break}X=u.value;if(!(X.expirationTimestamp&&Number(X.expirationTimestamp)<I)){v.GF(5);break}X.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";X.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.l(v,Z$(c,X,"offlineVideoPolicy"),5);
case 5:u=r.next();v.GF(4);break;case 6:return v.return(O.map(function(M){return M.key}))}})},RP=function(c,I,O,r,u){var X,v,M;
return g.E(function(G){if(G.C==1)return g.l(G,cy(),2);X=G.N;if(!X)return G.return([]);v=I.map(function(m){var n=g.MA(m,O);n={actionType:r,entityKey:n,actionMetadata:Object.assign({},p6$(),u)};r!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(n.actionMetadata.priority=0);m=new DD(O,m,n);return yc(m)});
M=e8k(X,v);ntO(c.W);return G.return(M)})},EFX=function(c,I,O,r){var u,X,v,M,G,m,n,h;
return g.E(function(V){switch(V.C){case 1:u=[],X=g.W(I),v=X.next();case 2:if(v.done){V.GF(4);break}M=v.value;if(M.upToDate||O&&!M.shouldAutoSyncMetadata||!M.playlistId){V.GF(3);break}G={};switch(r){case "mainPlaylistEntity":m={nextAutoRefreshIntervalSeconds:M.checkInSeconds,autoSync:O};G={mainPlaylistEntityActionMetadata:m};break;case "musicPlaylist":n={autoSync:O},G={musicPlaylistEntityActionMetadata:n}}return g.l(V,RP(c,[M.playlistId],r,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",G),6);case 6:(h=
V.N)&&u.push.apply(u,g.Y(h));case 3:v=X.next();V.GF(2);break;case 4:return V.return(u)}})},bqY=function(c,I){var O;
return g.E(function(r){return I.length?(O=p6$(),g.B4(O,$4,{isEnqueuedForExpiredStreamUrlRefetch:!0}),c.api.fV("qrd",{v:I.length}),r.return(RP(c,I,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",O))):r.return([])})},e_k=function(c,I,O){this.C=c;
this.uq=I;this.W=O},aQk=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t;
return g.E(function(T){switch(T.C){case 1:return O=G5(I),r=g.Pe(I.entityKey),u=r.entityId,X=[],g.yy(T,2),g.l(T,F8Y(c,u),4);case 4:X=T.N;if(!(c.uq.B("woffle_enable_main_downloads_library")&&((v=X)==null?0:v.length))){T.GF(5);break}return g.l(T,ot7(c.C,[I.entityKey]),5);case 5:g.YU(T,3);break;case 2:return M=g.Lz(T),G="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",m="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",M instanceof g.Da&&M.type==="QUOTA_EXCEEDED"?(G="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
m="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):uj("Playlist add error"),T.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,G,m));case 3:n=[];if(!c.uq.B("html5_offline_prevent_redownload_downloaded_video")){T.GF(7);break}return g.l(T,Y0Y(c.C,"mainVideoEntity",X),8);case 8:X=T.N;case 7:if((h=X)==null?0:h.length)for(V=g.W(X),A=V.next();!A.done;A=V.next())if(N=A.value,J=N.offlineVideoData,L=void 0,(L=J)==null?0:L.videoId)U=void 0,t=Number(((U=I.actionMetadata)==null?void 0:U.priority)||
0)+1,n.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",J.videoId,"mainVideoEntity",t,sf,$Qa(I,J,u)));return T.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,n))}})},kua=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv,rL,Au,p,C,H,b,F,IZ,Xx,vF,e,jU,Af,iF,Ed,n7,K7,nU,qm,KU,jE,ef,d8,nG,qS,Bg,w1,Y_,hD,eG,V1,F0,ab,ob,TD,cw,d1,rm,Cq,Br;
return g.E(function(hh){switch(hh.C){case 1:return O=G5(I),r=I.entityKey,u=g.Pe(r).entityId,X=[],v=!1,u==="!*$_ALL_ENTITIES_!*$"?(v=!0,g.l(hh,Qp(c.C,"mainPlaylistEntity"),5)):g.l(hh,zK(c.C,r,"mainPlaylistEntity"),4);case 4:(M=hh.N)&&X.push(M);hh.GF(3);break;case 5:X=hh.N;case 3:if((G=X)==null||!G.length)return hh.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));m=g.S(I.actionMetadata,oFb);h=(n=m)==null?void 0:n.nextAutoRefreshIntervalSeconds;A=(V=m)==null?void 0:V.autoSync;N=[];L=J=
!0;U=!1;if(!v&&A===!1){hh.GF(6);break}g.yy(hh,7);return g.l(hh,zys(0,!!A,!0,X),9);case 9:N=hh.N;g.YU(hh,8);break;case 7:t=g.Lz(hh);if(!(t instanceof Error&&t.message==="No data")){t instanceof Error&&t.message==="Empty response body"&&uj(t.message);hh.GF(8);break}return u==="!*$_ALL_ENTITIES_!*$"?g.l(hh,EtL(c.C,I,c.W,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.l(hh,lTL(u,c.C,I,c.W),8);case 8:if(!N.length||!v&&N[0].playlistId!==u)return hh.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O));case 6:if(v){T=[];a=g.W(N);for(K=a.next();!K.done;K=a.next())R=K.value,R.upToDate||A&&!R.shouldAutoSyncMetadata||!R.playlistId||(d={nextAutoRefreshIntervalSeconds:R.checkInSeconds,autoSync:A},T.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",R.playlistId,"mainPlaylistEntity",0,sf,{mainPlaylistEntityActionMetadata:d})));return hh.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,T))}N.length&&(uF=N[0],U=!!uF.upToDate,A&&(J=(PF=uF.shouldAutoSyncMetadata)!=null?PF:!0,L=(cF=uF.shouldAutoSyncVideos)!=
null?cF:!0,uF.checkInSeconds&&(h=uF.checkInSeconds)));if(U||!J)return hh.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));f=[];Q=X[0];if(!Q.downloadState){y=void 0;hh.GF(15);break}return g.l(hh,zK(c.C,Q.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:y=hh.N;case 15:return q=y,Ju=((BF=q)==null?0:BF.addedTimestampMillis)?String(q.addedTimestampMillis):void 0,g.yy(hh,17),g.l(hh,F8Y(c,u,Ju,h),19);case 19:f=hh.N;g.YU(hh,18);break;case 17:mk=g.Lz(hh);if(!(mk instanceof Error&&
mk.message==="No data for playlist")){if(mk instanceof Error&&mk.message==="Empty response body for playlist")uj(mk.message);else return tf="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Zv="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",mk instanceof g.Da&&mk.type==="QUOTA_EXCEEDED"&&(tf="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Zv="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),hh.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,tf,Zv));hh.GF(18);
break}return g.l(hh,lTL(u,c.C,I,c.W),18);case 18:if(!L)return hh.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));rL=[];Au=new Map;if((p=f)==null?0:p.length)for(C=g.W(f),H=C.next();!H.done;H=C.next())b=H.value,F=b.offlineVideoData,IZ=void 0,((IZ=F)==null?0:IZ.videoId)&&Au.set(F.videoId,F);Xx=new Map;vF=[];if((e=Q)==null?0:(jU=e.videos)==null?0:jU.length)for(Af=g.W(Q.videos),iF=Af.next();!iF.done;iF=Af.next())if(Ed=iF.value,n7=JSON.parse(g.Pe(Ed).entityId),K7=n7.videoId)Au.has(K7)?(Xx.set(K7,
Au.get(K7)),Au.delete(K7)):vF.push(K7);qm=Number(((nU=I.actionMetadata)==null?void 0:nU.priority)||0)+1;KU=g.W(Au.entries());for(jE=KU.next();!jE.done;jE=KU.next())ef=jE.value,d8=g.W(ef),nG=d8.next().value,qS=d8.next().value,Bg=nG,w1=qS,rL.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",Bg,"mainVideoEntity",qm,sf,$Qa(I,w1,u)));Y_=g.W(Xx.entries());for(hD=Y_.next();!hD.done;hD=Y_.next())eG=hD.value,V1=g.W(eG),F0=V1.next().value,ab=V1.next().value,ob=F0,TD=ab,rL.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
ob,"mainVideoEntity",qm,sf,$Qa(I,TD,u)));cw=g.W(vF);for(d1=cw.next();!d1.done;d1=cw.next())rm=d1.value,Cq={playlistId:u},Br={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:Cq},rL.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",rm,"mainVideoEntity",0,sf,Br));return hh.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,rL))}})},K8k=function(c,I){var O,r,u,X;
return g.E(function(v){switch(v.C){case 1:return O=G5(I),g.yy(v,2),r=g.Pe(I.entityKey).entityId,r==="!*$_ALL_ENTITIES_!*$"?g.l(v,EtL(c.C,I,c.W,(u=I.actionMetadata)==null?void 0:(X=u.offlineLoggingData)==null?void 0:X.offlineDeleteReason),5):g.l(v,lTL(r,c.C,I,c.W),6);case 6:if(!c.uq.B("woffle_enable_main_downloads_library")){v.GF(5);break}return g.l(v,kZL(c.C,I.entityKey),5);case 5:g.YU(v,3);break;case 2:return g.Lz(v),v.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return v.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O))}})},F8Y=function(c,I,O,r){var u,X,v,M,G,m,n;
return g.E(function(h){switch(h.C){case 1:return g.l(h,x8L([I]),2);case 2:return u=h.N,g.l(h,BCs(c,u[0],O,r),3);case 3:return X=h.N,v=X.mainPlaylistEntity,M=X.bDh,m=tQu(v,(G=M)==null?void 0:G.avatar),g.yy(h,4),g.l(h,Y4(m),6);case 6:g.YU(h,5);break;case 4:n=g.Lz(h),n instanceof Error&&n.message==="Failed to fetch"&&uj(n.message);case 5:return h.return(u[0].videos)}})},BCs=function(c,I,O,r){var u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a;
return g.E(function(K){switch(K.C){case 1:u=Date.now().toString();O||(O=u);X=I.videos;v=I.playlistId;M=[];G=[];if(X)for(m=g.W(X),n=m.next();!n.done;n=m.next()){h=n.value;V=h.offlineVideoData;if(!V||!V.videoId)throw uj("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");A=V.videoId;N={videoId:A,playlistId:v};J={id:g.MA(JSON.stringify(N),"mainPlaylistVideoEntity"),video:g.MA(A,"mainVideoEntity")};M.push(J);G.push(J.id)}U={key:g.MA(v,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:O,lastSyncedTimestampMillis:u};t={key:g.MA(v,"mainPlaylistEntity"),playlistId:v,videos:G,title:I.title,thumbnailStyleData:S6Y(I),visibility:gFs(I),downloadState:U.key};I.channel&&(T=I.channel.offlineChannelData,L=fQt(g.MA(v,"ytMainChannelEntity"),T),t.channelOwner=L.id);((a=t)==null?0:a.entityMetadata)?(t.entityMetadata.offlineLastModifiedTimestampSeconds=I.lastModifiedTimestamp,r&&(t.entityMetadata.nextAutoRefreshIntervalSeconds=String(r))):t&&(t.entityMetadata={nextAutoRefreshIntervalSeconds:r?
String(r):void 0,offlineLastModifiedTimestampSeconds:I.lastModifiedTimestamp});g.yy(K,2);return g.l(K,xk(c.C,{mode:"readwrite",Zw:!0},function(R){var d=qu(R,t,"mainPlaylistEntity"),uF=qu(R,U,"mainPlaylistDownloadStateEntity");d=[d,uF];uF=g.W(M);for(var PF=uF.next();!PF.done;PF=uF.next())d.push(qu(R,PF.value,"mainPlaylistVideoEntity"));L&&d.push(qu(R,L,"ytMainChannelEntity"));return g.U2.all(d)}),4);
case 4:g.YU(K,3);break;case 2:throw g.Lz(K),uj("PES failure for playlist"),Error("PES failure for playlist");case 3:return K.return({mainPlaylistEntity:t,bDh:L,QVV:M})}})},fQt=function(c,I){return{id:c,
channelId:I.channelId,title:I.title,avatar:I.thumbnail}},S6Y=function(c){var I=[],O=c.videos;
O&&O.length>0&&I.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:O[0].offlineVideoData.thumbnail}}});if((c=c.additionalMetadadatas)&&c.length>0)for(c=g.W(c),O=c.next();!O.done;O=c.next()){var r=O.value.offlineBundleItemPlaylistData,u=void 0;O=(u=r)==null?void 0:u.style;u=void 0;r={collageThumbnail:{coverThumbnail:(u=r)==null?void 0:u.coverThumbnail}};switch(O){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":I.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:r});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":I.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:r});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":I.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:r});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":I.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:r})}}return I},gFs=function(c){switch(c.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},$Qa=function(c,I,O){I={offlineVideoData:I,
playlistId:O};if(c=g.S(c.actionMetadata,oFb))I.maximumDownloadQuality=c.maximumDownloadQuality;return{mainVideoEntityActionMetadata:I}},q6a=function(c,I,O){this.C=c;
this.uq=I;this.W=O},R_$=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N;
return g.E(function(J){switch(J.C){case 1:return O=G5(I),r=g.Pe(I.entityKey),u=r.entityId,X=g.S(I.actionMetadata,x4),M=!((v=X)==null?0:v.playlistId),g.yy(J,2),g.l(J,wtX(c,u,void 0,(G=X)==null?void 0:G.offlineVideoData,M),4);case 4:g.YU(J,3);break;case 2:return m=g.Lz(J),n="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",h="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",m instanceof g.Da&&m.type==="QUOTA_EXCEEDED"&&(n="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",h="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
J.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,n,h));case 3:V=1;V=Number(((A=I.actionMetadata)==null?void 0:A.priority)||0)+1;var L=(L=g.S(I.actionMetadata,x4))?{playbackDataActionMetadata:{maximumDownloadQuality:L.maximumDownloadQuality}}:void 0;N=eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",u,"playbackData",V,dQb,L);return J.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,[N]))}})},s6O=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t;
return g.E(function(T){switch(T.C){case 1:return O=G5(I),r=g.Pe(I.entityKey),u=r.entityId,g.l(T,zK(c.C,I.entityKey,"mainVideoEntity"),2);case 2:X=T.N;if(!X){v=void 0;T.GF(3);break}return g.l(T,zK(c.C,X.downloadState,"mainVideoDownloadStateEntity"),4);case 4:v=T.N;case 3:M=v;if(!X||!M)return T.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));g.yy(T,5);return g.l(T,wtX(c,u,M.addedTimestampMillis,(m=g.S(I.actionMetadata,x4))==null?void 0:m.offlineVideoData),7);case 7:n=1;n=Number(((h=
I.actionMetadata)==null?void 0:h.priority)||0)+1;G=eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",u,"playbackData",n,dQb);g.YU(T,6);break;case 5:V=g.Lz(T);if(!(V instanceof Error&&V.message==="No data")){if(V instanceof Error&&V.message==="Empty response body")uj(V.message);else return A="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",N="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",V instanceof g.Da&&V.type==="QUOTA_EXCEEDED"&&(A="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
N="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),T.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,A,N));T.GF(6);break}return g.l(T,Uf(c.C,u),9);case 9:J=T.N;L=g.S(I.actionMetadata,x4);if(t=(U=L)==null?void 0:U.playlistId)J.playlistId=t;J.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.l(T,LI(u,c.C,I,c.W,J),6);case 6:return T.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,G?[G]:void 0))}})},xQk=function(c,I){var O,r,u,X,v,M,G,m,n,h;
return g.E(function(V){switch(V.C){case 1:return O=G5(I),g.yy(V,2),r=g.Pe(I.entityKey).entityId,r==="!*$_ALL_ENTITIES_!*$"?g.l(V,EtL(c.C,I,c.W,(n=I.actionMetadata)==null?void 0:(h=n.offlineLoggingData)==null?void 0:h.offlineDeleteReason),5):g.l(V,Uf(c.C,r),6);case 6:u=V.N;X=g.S(I.actionMetadata,x4);if(M=(v=X)==null?void 0:v.playlistId)u.playlistId=M;u.offlineDeleteReason=(G=I.actionMetadata)==null?void 0:(m=G.offlineLoggingData)==null?void 0:m.offlineDeleteReason;return g.l(V,LI(r,c.C,I,c.W,u),7);
case 7:if(!c.uq.B("woffle_enable_main_downloads_library")){V.GF(5);break}return g.l(V,kZL(c.C,I.entityKey),5);case 5:g.YU(V,3);break;case 2:return g.Lz(V),V.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return V.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O))}})},wtX=function(c,I,O,r,u){var X,v,M,G,m,n;
return g.E(function(h){switch(h.C){case 1:if(X=r){h.GF(2);break}return g.l(h,sDu([I]),3);case 3:v=h.N,X=v[0];case 2:return g.l(h,Zqk(c,X,O,u),4);case 4:M=h.N;G=M.mainVideoEntity;m=M.channelEntity;g.yy(h,5);var V=N7(G.thumbnail),A=N7(m.avatar);return g.l(h,Y4(V.concat(A)),7);case 7:g.YU(h,0);break;case 5:n=g.Lz(h),n instanceof Error&&n.message==="Failed to fetch"&&uj(n.message),g.WF(h)}})},Zqk=function(c,I,O,r){var u,X,v,M,G,m,n,h,V,A,N,J,L;
return g.E(function(U){switch(U.C){case 1:O||(O=Date.now().toString());X=(u=I.channel)==null?void 0:u.offlineChannelData;v={id:g.MA(I.videoId,"ytMainChannelEntity"),channelId:X.channelId,title:X.title,avatar:X.thumbnail};M={key:g.MA(I.videoId,"mainVideoDownloadStateEntity"),playbackData:g.MA(I.videoId,"playbackData"),addedTimestampMillis:O,videoDownloadContextEntity:g.MA(I.videoId,"videoDownloadContextEntity")};G={key:g.MA(I.videoId,"videoPlaybackPositionEntity"),videoId:I.videoId,lastPlaybackPositionSeconds:"0"};
c.uq.B("html5_offline_playback_position_sync")&&(m={playbackPosition:G.key});n=g.MA(I.videoId,"mainVideoEntity");h={key:n,videoId:I.videoId,title:I.title,thumbnail:I.thumbnail,localizedStrings:{viewCount:I.shortViewCountText},userState:m,lengthSeconds:I.lengthSeconds?Number(I.lengthSeconds):void 0,publishedTimestampMillis:I.publishedTimestamp?(Number(I.publishedTimestamp)*1E3).toString():void 0,formattedDescription:I.description,owner:v.id,downloadState:M.key};if(!c.uq.B("woffle_enable_main_downloads_library")||
!r){U.GF(2);break}return g.l(U,aTO(c.C,[n]),3);case 3:if(N=U.N)V=N.mainDownloadsLibraryEntity,A=N.mainDownloadsListEntity;case 2:return L=J_O,J={key:g.MA(I.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.B4(M,L,J),g.l(U,xk(c.C,{mode:"readwrite",Zw:!0},function(t){var T=qu(t,v,"ytMainChannelEntity"),a=qu(t,M,"mainVideoDownloadStateEntity"),K=qu(t,h,"mainVideoEntity");T=[T,a,K];c.uq.B("html5_offline_playback_position_sync")&&(a=qu(t,G,"videoPlaybackPositionEntity"),
T.push(a));V&&(a=qu(t,V,"mainDownloadsLibraryEntity"),T.push(a));A&&(a=qu(t,A,"mainDownloadsListEntity"),T.push(a));J&&(t=qu(t,J,"downloadStatusEntity"),T.push(t));return g.U2.all(T)}),4);
case 4:return U.return({mainVideoEntity:h,channelEntity:v})}})},z_7=function(c,I,O){this.C=c;
this.uq=I;this.W=O},c9$=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q;
return g.E(function(y){switch(y.C){case 1:return O=G5(I),r=[],g.l(y,kk.getInstance(),2);case 2:u=y.N;if(!u){y.GF(3);break}return g.l(y,u.get("sdois"),4);case 4:return X=y.N,g.l(y,(M=u)==null?void 0:M.get("lmqf"),5);case 5:v=y.N;case 3:g.yy(y,6);if(X===void 0)throw Error("prefStorage or opt-in state is undefined");G=[];if(X){y.GF(8);break}return g.l(y,$8a(c.C),9);case 9:G=y.N,G.reverse();case 8:if(!G.length){y.GF(10);break}m=g.W(G);n=m.next();case 11:if(n.done){y.GF(10);break}h=n.value;if(!h){y.GF(12);
break}V=g.Pe(h).entityId;return g.l(y,Uf(c.C,V),14);case 14:return A=y.N,A.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.l(y,LI(V,c.C,{entityKey:h,actionType:I.actionType},c.W,A),12);case 12:n=m.next();y.GF(11);break;case 10:return g.l(y,cda(X,(N=v)!=null?N:"SD"),16);case 16:return J=y.N,g.l(y,btk(J),17);case 17:L=Fea(J);if(!c.uq.B("woffle_enable_main_downloads_library")){y.GF(18);break}if(X){y.GF(19);break}return g.l(y,kZL(c.C,g.$c),19);case 19:return g.l(y,ot7(c.C,[g.$c]),18);
case 18:if((U=L)==null?0:U.length)for(t=g.W(L),T=t.next();!T.done;T=t.next())if(K=a=T.value,R=K.actionType,d=K.entityKey,uF=K.actionMetadata,R&&d&&uF&&!g.S(uF,Q6k)){R==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(uF.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if(PF=g.S(a.actionMetadata,x4))PF.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",a.actionMetadata=Object.assign({},a.actionMetadata,{mainVideoEntityActionMetadata:PF});r.push(a)}g.YU(y,7);break;
case 6:return cF=g.Lz(y),f="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Q="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",cF instanceof g.Da&&cF.type==="QUOTA_EXCEEDED"&&(f="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Q="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),y.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,f,Q));case 7:return y.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,r))}})},Iju=function(){dD.apply(this,arguments);
this.j="mainVideoEntity"},Ooz=function(c,I,O){I=I===void 0?43200:I;
O=O===void 0?!0:O;var r=r===void 0?!1:r;var u,X,v;return g.E(function(M){switch(M.C){case 1:if(!c.G.Vf())return M.return([]);u=[];g.yy(M,2);return g.l(M,zys(I,O,r),4);case 4:u=M.N;g.YU(M,3);break;case 2:X=g.Lz(M),X instanceof Error&&X.message==="No data"||X instanceof Error&&X.message==="Empty response body"&&uj(X.message);case 3:return v=EFX(c,u,O,"mainPlaylistEntity"),M.return(v)}})},r9k=function(c,I,O,r){r=r===void 0?!1:r;
var u,X,v,M,G,m,n,h,V,A,N,J,L,U,t;return g.E(function(T){switch(T.C){case 1:return u=[],g.l(T,QDk(),2);case 2:return(X=T.N)||r?g.l(T,Icu(I,O),3):T.return([]);case 3:v=T.N;if((M=v)==null||!M.length)return T.return([]);G={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};m=g.W(v);n=m.next();case 4:if(n.done){T.GF(6);break}V=h=n.value;A=V.actionType;N=V.entityKey;J=V.actionMetadata;if(!(A&&N&&J)||g.S(J,Q6k)){T.GF(5);break}A==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(J.offlineLoggingData=
G);L=g.Pe(N);U=L.entityId;return g.l(T,RP(c,[U],"mainVideoEntity",A,J),8);case 8:t=T.N,u=u.concat(t);case 5:n=m.next();T.GF(4);break;case 6:return T.return(u)}})},ug$=function(c,I){this.C=c;
this.W=I},v2z=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U;
return g.E(function(t){switch(t.C){case 1:return O=G5(I),r=g.Pe(I.entityKey),u=r.entityId,X=[],g.yy(t,2),g.l(t,XRk(c,u),4);case 4:X=t.N;if((v=X)==null||!v.length){t.GF(5);break}return g.l(t,fT7(c.C,I.entityKey),5);case 5:g.YU(t,3);break;case 2:return M=g.Lz(t),G="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",m="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",M instanceof g.Da&&M.type==="QUOTA_EXCEEDED"&&(G="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",m="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
t.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,G,m));case 3:return n=[],g.l(t,Y0Y(c.C,"musicTrack",X),7);case 7:X=t.N;if(X.length)for(h=g.W(X),V=h.next();!V.done;V=h.next())if(A=V.value,N=A.offlineVideoData,J=void 0,(J=N)==null?0:J.videoId)L=void 0,U=Number(((L=I.actionMetadata)==null?void 0:L.priority)||0)+1,n.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",N.videoId,"musicTrack",U,ZD,lj(I,N,u)));return t.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,n))}})},
Pdb=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv,rL,Au,p,C,H,b,F,IZ,Xx,vF,e,jU,Af,iF,Ed,n7,K7,nU,qm,KU,jE,ef,d8,nG,qS;
return g.E(function(Bg){switch(Bg.C){case 1:return O=G5(I),r=I.entityKey,u=g.Pe(r).entityId,X=[],v=!1,u==="!*$_ALL_ENTITIES_!*$"?(v=!0,g.l(Bg,Qp(c.C,"musicAlbumRelease"),5)):g.l(Bg,zK(c.C,r,"musicAlbumRelease"),4);case 4:(M=Bg.N)&&X.push(M);Bg.GF(3);break;case 5:X=Bg.N;case 3:if((G=X)==null||!G.length)return Bg.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));if(v){m=[];n=g.W(X);for(h=n.next();!h.done;h=n.next())V=h.value,A=g.Pe(V.id).entityId,m.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
A,"musicAlbumRelease",0,ZD));return Bg.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,m))}N=[];J=X[0];L=void 0;if(!J.downloadMetadata){Bg.GF(6);break}return g.l(Bg,zK(c.C,J.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:U=Bg.N,L=Number((T=(t=U)==null?void 0:t.addedTimestampMillis)!=null?T:"0")/1E3;case 6:return g.yy(Bg,8),g.l(Bg,XRk(c,u,(a=L)==null?void 0:a.toString()),10);case 10:N=Bg.N;g.YU(Bg,9);break;case 8:K=g.Lz(Bg);if(!(K instanceof Error&&K.message===
"No data")){if(K instanceof Error&&K.message==="Empty response body")uj(K.message);else return R="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",d="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",K instanceof g.Da&&K.type==="QUOTA_EXCEEDED"&&(R="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",d="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Bg.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,R,d));Bg.GF(9);break}return g.l(Bg,tn(u,"musicAlbumRelease",c.C,
I,c.W),9);case 9:uF=[];PF=new Map;if((cF=N)==null?0:cF.length)for(f=g.W(N),Q=f.next();!Q.done;Q=f.next())y=Q.value,q=y.offlineVideoData,BF=void 0,((BF=q)==null?0:BF.videoId)&&PF.set(q.videoId,q);Ju=new Map;mk=[];if((tf=J)==null?0:(Zv=tf.tracks)==null?0:Zv.length)for(rL=g.W(J.tracks),Au=rL.next();!Au.done;Au=rL.next())if(p=Au.value,C=g.Pe(p).entityId)PF.has(C)?(Ju.set(C,PF.get(C)),PF.delete(C)):mk.push(C);b=Number(((H=I.actionMetadata)==null?void 0:H.priority)||0)+1;F=g.W(PF.entries());for(IZ=F.next();!IZ.done;IZ=
F.next())Xx=IZ.value,vF=g.W(Xx),e=vF.next().value,jU=vF.next().value,Af=e,iF=jU,uF.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",Af,"musicTrack",b,ZD,lj(I,iF)));Ed=g.W(Ju.entries());for(n7=Ed.next();!n7.done;n7=Ed.next())K7=n7.value,nU=g.W(K7),qm=nU.next().value,KU=nU.next().value,jE=qm,ef=KU,uF.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",jE,"musicTrack",b,ZD,lj(I,ef)));d8=g.W(mk);for(nG=d8.next();!nG.done;nG=d8.next())qS=nG.value,uF.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",qS,
"musicTrack",0,ZD));return Bg.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,uF))}})},MJs=function(c,I){var O,r;
return g.E(function(u){switch(u.C){case 1:return O=G5(I),g.yy(u,2),r=g.Pe(I.entityKey).entityId,r==="!*$_ALL_ENTITIES_!*$"?g.l(u,Hy(c.C,I,c.W),5):g.l(u,tn(r,"musicAlbumRelease",c.C,I,c.W),6);case 6:return g.l(u,q0X(c.C,I.entityKey),5);case 5:g.YU(u,3);break;case 2:return g.Lz(u),u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O))}})},XRk=function(c,I,O){var r,u,X;
return g.E(function(v){switch(v.C){case 1:return g.l(v,x8L([I]),2);case 2:return r=v.N,g.l(v,io$(c,r[0],O),3);case 3:return u=v.N,X=N7(u.thumbnailDetails),g.l(v,Y4(X),4);case 4:return v.return(r[0].videos)}})},io$=function(c,I,O){var r,u,X,v,M,G,m,n,h,V,A,N,J,L;
return g.E(function(U){if(U.C==1){r=I.additionalMetadadatas;u=void 0;if(r&&r.length>0)for(X=g.W(r),v=X.next();!v.done;v=X.next())if(M=v.value,M.offlineMusicPlaylistData){u=M.offlineMusicPlaylistData;break}G=I.playlistId;m=w67(I);n=m.kz;h=m.iD;V=O?(Number(O)*1E3).toString():Date.now().toString();A=I.lastModifiedTimestamp?(Number(I.lastModifiedTimestamp)*1E3).toString():"0";N={id:g.MA(G,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:h,lastModifiedTimestampMillis:A,addedTimestampMillis:V,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};J={id:g.MA(G,"musicAlbumRelease"),title:I.title,audioPlaylistId:G,trackCount:I.totalVideoCount,tracks:n,downloadMetadata:N.id};u&&(J.thumbnailDetails=(L=u.albumHqThumbnail)!=null?L:u.albumArtistThumbnail,J.artistDisplayName=u.albumArtistDisplayName,J.releaseDate=u.albumReleaseDate,J.contentRating={explicitType:u.albumReleaseExplicitType},J.releaseType=u.albumReleaseType);return g.l(U,xk(c.C,{mode:"readwrite",Zw:!0},function(t){var T=qu(t,J,"musicAlbumRelease");
t=qu(t,N,"musicAlbumReleaseDownloadMetadataEntity");return g.U2.all([T,t])}),2)}return U.return(J)})},GVs=function(c,I){this.C=c;
this.W=I},mpL=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U;
return g.E(function(t){switch(t.C){case 1:return O=G5(I),r=g.Pe(I.entityKey),u=r.entityId,X=[],g.yy(t,2),g.l(t,jWk(c,u),4);case 4:X=t.N;if((v=X)==null||!v.length){t.GF(5);break}return g.l(t,fT7(c.C,I.entityKey),5);case 5:g.YU(t,3);break;case 2:return M=g.Lz(t),G="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",m="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",M instanceof g.Da&&M.type==="QUOTA_EXCEEDED"&&(G="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",m="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
t.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,G,m));case 3:return n=[],g.l(t,Y0Y(c.C,"musicTrack",X),7);case 7:X=t.N;if(X.length)for(h=g.W(X),V=h.next();!V.done;V=h.next())if(A=V.value,N=A.offlineVideoData,J=void 0,(J=N)==null?0:J.videoId)L=void 0,U=Number(((L=I.actionMetadata)==null?void 0:L.priority)||0)+1,n.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",N.videoId,"musicTrack",U,z5,lj(I,N,u)));return t.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,n))}})},
n2k=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv,rL,Au,p,C,H,b,F,IZ,Xx,vF,e,jU,Af,iF,Ed,n7,K7,nU,qm,KU,jE,ef,d8,nG,qS,Bg,w1,Y_,hD,eG,V1,F0,ab,ob,TD,cw,d1;
return g.E(function(rm){switch(rm.C){case 1:return O=G5(I),r=I.entityKey,u=g.Pe(r).entityId,X=[],v=!1,u==="!*$_ALL_ENTITIES_!*$"?(v=!0,g.l(rm,Qp(c.C,"musicPlaylist"),5)):g.l(rm,zK(c.C,r,"musicPlaylist"),4);case 4:(M=rm.N)&&X.push(M);rm.GF(3);break;case 5:X=rm.N;case 3:if((G=X)==null||!G.length)return rm.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));m=g.S(I.actionMetadata,d8u);h=(n=m)==null?void 0:n.autoSync;V=[];N=A=!0;J=!1;L=void 0;if(!v&&h===!1){rm.GF(6);break}g.yy(rm,7);return g.l(rm,
OQz(0,!!h,!0,X),9);case 9:V=rm.N;g.YU(rm,8);break;case 7:U=g.Lz(rm);if(!(U instanceof Error&&U.message==="No data")){U instanceof Error&&U.message==="Empty response body"&&uj(U.message);rm.GF(8);break}return u==="!*$_ALL_ENTITIES_!*$"?g.l(rm,Hy(c.C,I,c.W),8):g.l(rm,tn(u,"musicPlaylist",c.C,I,c.W),8);case 8:if(!V.length||!v&&V[0].playlistId!==u)return rm.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));case 6:if(v){t=[];T=g.W(V);for(a=T.next();!a.done;a=T.next())K=a.value,K.upToDate||
h&&!K.shouldAutoSyncMetadata||!K.playlistId||(R={autoSync:h},t.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",K.playlistId,"musicPlaylist",0,z5,{musicPlaylistEntityActionMetadata:R})));return rm.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,t))}V.length&&(d=V[0],J=!!d.upToDate,h&&(A=(uF=d.shouldAutoSyncMetadata)!=null?uF:!0,N=(PF=d.shouldAutoSyncVideos)!=null?PF:!0,d.checkInSeconds&&(L=d.checkInSeconds)));if(J||!A)return rm.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O));cF=[];f=X[0];Q=void 0;if(!f.downloadMetadata){rm.GF(15);break}return g.l(rm,zK(c.C,f.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:y=rm.N,Q=Number((BF=(q=y)==null?void 0:q.addedTimestampMillis)!=null?BF:"0")/1E3;case 15:return g.yy(rm,17),g.l(rm,jWk(c,u,(Ju=Q)==null?void 0:Ju.toString(),L),19);case 19:cF=rm.N;g.YU(rm,18);break;case 17:mk=g.Lz(rm);if(!(mk instanceof Error&&mk.message==="No data")){if(mk instanceof Error&&mk.message==="Empty response body")uj(mk.message);else return tf=
"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Zv="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",mk instanceof g.Da&&mk.type==="QUOTA_EXCEEDED"&&(tf="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Zv="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),rm.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,tf,Zv));rm.GF(18);break}return g.l(rm,tn(u,"musicPlaylist",c.C,I,c.W),18);case 18:if(!N)return rm.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O));rL=[];Au=new Map;if((p=cF)==null?0:p.length)for(C=g.W(cF),H=C.next();!H.done;H=C.next())b=H.value,F=b.offlineVideoData,IZ=void 0,((IZ=F)==null?0:IZ.videoId)&&Au.set(F.videoId,F);Xx=new Map;vF=[];if((e=f)==null?0:(jU=e.tracks)==null?0:jU.length)for(Af=g.W(f.tracks),iF=Af.next();!iF.done;iF=Af.next())if(Ed=iF.value,n7=g.Pe(Ed).entityId)Au.has(n7)?(Xx.set(n7,Au.get(n7)),Au.delete(n7)):vF.push(n7);nU=Number(((K7=I.actionMetadata)==null?void 0:K7.priority)||0)+1;qm=g.W(Au.entries());for(KU=qm.next();!KU.done;KU=
qm.next())jE=KU.value,ef=g.W(jE),d8=ef.next().value,nG=ef.next().value,qS=d8,Bg=nG,rL.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",qS,"musicTrack",nU,z5,lj(I,Bg)));w1=g.W(Xx.entries());for(Y_=w1.next();!Y_.done;Y_=w1.next())hD=Y_.value,eG=g.W(hD),V1=eG.next().value,F0=eG.next().value,ab=V1,ob=F0,rL.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",ab,"musicTrack",nU,z5,lj(I,ob)));TD=g.W(vF);for(cw=TD.next();!cw.done;cw=TD.next())d1=cw.value,rL.push(eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
d1,"musicTrack",0,z5));return rm.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,rL))}})},hgk=function(c,I){var O,r;
return g.E(function(u){switch(u.C){case 1:return O=G5(I),g.yy(u,2),r=g.Pe(I.entityKey).entityId,r==="!*$_ALL_ENTITIES_!*$"?g.l(u,Hy(c.C,I,c.W),5):g.l(u,tn(r,"musicPlaylist",c.C,I,c.W),6);case 6:return g.l(u,q0X(c.C,I.entityKey),5);case 5:g.YU(u,3);break;case 2:return g.Lz(u),u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O))}})},jWk=function(c,I,O,r){var u,X,v;
return g.E(function(M){switch(M.C){case 1:return g.l(M,x8L([I]),2);case 2:return u=M.N,g.l(M,VJs(c,u[0],O,r),3);case 3:return X=M.N,v=N7(X.thumbnailDetails),g.l(M,Y4(v),4);case 4:return M.return(u[0].videos)}})},VJs=function(c,I,O,r){var u,X,v,M,G,m,n,h,V;
return g.E(function(A){return A.C==1?(u=I.playlistId,X=w67(I),v=X.kz,M=X.iD,G=O?(Number(O)*1E3).toString():Date.now().toString(),m=I.lastModifiedTimestamp?(Number(I.lastModifiedTimestamp)*1E3).toString():"0",n={id:g.MA(u,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:M,lastModifiedTimestampMillis:m,addedTimestampMillis:G,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},h={id:g.MA(u,"musicPlaylist"),title:I.title,playlistId:u,thumbnailDetails:I.thumbnail,visibility:A9k(I),trackCount:I.totalVideoCount,
tracks:v,downloadMetadata:n.id},r&&(((V=h)==null?0:V.entityMetadata)?h.entityMetadata.nextAutoRefreshIntervalSeconds=String(r):h&&(h.entityMetadata={nextAutoRefreshIntervalSeconds:String(r)})),g.l(A,xk(c.C,{mode:"readwrite",Zw:!0},function(N){var J=qu(N,h,"musicPlaylist");N=qu(N,n,"musicPlaylistDownloadMetadataEntity");return g.U2.all([J,N])}),2)):A.return(h)})},A9k=function(c){switch(c.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},Nik=function(c,I){this.C=c;
this.W=I},J9X=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N;
return g.E(function(J){switch(J.C){case 1:return O=G5(I),r=g.Pe(I.entityKey),u=r.entityId,X=g.S(I.actionMetadata,DpX),g.yy(J,2),g.l(J,WgO(c,u,void 0,(v=X)==null?void 0:v.track,(M=X)==null?void 0:M.albumRelease),4);case 4:if((G=X)==null?0:G.playlistId){J.GF(5);break}return g.l(J,fT7(c.C,I.entityKey),5);case 5:g.YU(J,3);break;case 2:return m=g.Lz(J),n="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",h="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",m instanceof g.Da&&m.type==="QUOTA_EXCEEDED"&&
(n="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",h="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),J.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,n,h));case 3:A=Number(((V=I.actionMetadata)==null?void 0:V.priority)||0)+1;var L=(L=g.S(I.actionMetadata,DpX))?{playbackDataActionMetadata:{maximumDownloadQuality:L.maximumDownloadQuality}}:void 0;N=eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",u,"playbackData",A,y97,L);return J.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O,[N]))}})},Y$z=function(c,I){var O,r,u,X,v,M,G,m,n,h,V,A,N,J,L;
return g.E(function(U){switch(U.C){case 1:return O=G5(I),r=g.Pe(I.entityKey),u=r.entityId,g.l(U,zK(c.C,I.entityKey,"musicTrack"),2);case 2:X=U.N;if(!X){v=void 0;U.GF(3);break}return g.l(U,zK(c.C,X.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:v=U.N;case 3:M=v;if(!X||!M)return U.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O));m=g.S(I.actionMetadata,DpX);g.yy(U,5);return g.l(U,WgO(c,u,M.addedTimestampMillis,(n=m)==null?void 0:n.track,(h=m)==null?void 0:h.albumRelease),
7);case 7:A=Number(((V=I.actionMetadata)==null?void 0:V.priority)||0)+1;G=eD("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",u,"playbackData",A,y97);g.YU(U,6);break;case 5:N=g.Lz(U);if(!(N instanceof Error&&N.message==="No data")){if(N instanceof Error&&N.message==="Empty response body")uj(N.message);else return J="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",L="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",N instanceof g.Da&&N.type==="QUOTA_EXCEEDED"&&(J="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
L="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),U.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,J,L));U.GF(6);break}return g.l(U,CI(u,c.C,I,c.W),6);case 6:return U.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",O,G?[G]:void 0))}})},Lgk=function(c,I){var O,r;
return g.E(function(u){switch(u.C){case 1:return O=G5(I),g.yy(u,2),r=g.Pe(I.entityKey).entityId,r==="!*$_ALL_ENTITIES_!*$"?g.l(u,Hy(c.C,I,c.W),5):g.l(u,CI(r,c.C,I,c.W),6);case 6:return g.l(u,q0X(c.C,I.entityKey),5);case 5:g.YU(u,3);break;case 2:return g.Lz(u),u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",O,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return u.return(new Fr("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
O))}})},WgO=function(c,I,O,r,u){var X,v,M,G,m,n;
return g.E(function(h){switch(h.C){case 1:if(X=r){h.GF(2);break}return g.l(h,sDu([I]),3);case 3:v=h.N,M=v[0],X=gtL(M);case 2:return g.l(h,pR7(c,X,I,u,O),4);case 4:G=h.N;m=G.musicTrackEntity;n=G.VW;var V=N7(m.thumbnailDetails),A=[];n&&(A=N7(n.thumbnailDetails));return g.l(h,Y4(V.concat(A)),0)}})},pR7=function(c,I,O,r,u){var X;
return g.E(function(v){return v.C==1?(u||(u=Date.now().toString()),X={id:g.MA(O,"musicTrackDownloadMetadataEntity"),playbackData:g.MA(O,"playbackData"),addedTimestampMillis:u,videoDownloadContextEntity:g.MA(O,"videoDownloadContextEntity")},r&&(I.albumRelease=r.id),g.l(v,xk(c.C,{mode:"readwrite",Zw:!0},function(M){var G=[],m=qu(M,X,"musicTrackDownloadMetadataEntity");G.push(m);m=qu(M,I,"musicTrack");G.push(m);r&&(M=qu(M,r,"musicAlbumRelease"),G.push(M));return g.U2.all(G)}),2)):v.C!=3?g.l(v,hn(O,"musicTrackDownloadMetadataEntity",
c.C,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):v.return({musicTrackEntity:I,
VW:r})})},Qc=function(){dD.apply(this,arguments);
this.j="musicTrack"},Upb=function(c,I,O){I=I===void 0?43200:I;
O=O===void 0?!0:O;var r=r===void 0?!1:r;var u,X;return g.E(function(v){switch(v.C){case 1:if(!c.G.Vf())return v.return([]);u=[];g.yy(v,2);return g.l(v,OQz(I,O,r),4);case 4:u=v.N;g.YU(v,3);break;case 2:g.Lz(v);case 3:return X=EFX(c,u,O,"musicPlaylist"),v.return(X)}})},CdL=function(){g.tI.apply(this,arguments);
var c=this;this.events=new g.$R(this);this.uq=this.player.J();this.x5={mkV:function(){return c.C},
yu:function(){return c.yu()},
sY:function(I){return c.sY(I)}}},tJk=function(c){var I;
c=g.S((I=c.getWatchNextResponse())==null?void 0:I.currentVideoEndpoint,g.RV);if(c==null?0:c.playlistId)var O=c.playlistId;return O},Hok=function(c,I){var O,r,u,X;
return g.E(function(v){if(v.C==1){O=I.clientPlaybackNonce;r={cpn:O,offlineSourceVisualElement:g.Lv(I.H0||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};I.N&&(r.videoFmt=Number(I.N.itag));I.Y&&(r.audioFmt=Number(I.Y.itag));if((u=tJk(I))&&I.videoId){var M=I.videoId;M=u!=="PPSV"?Promise.resolve(!1):c.C.k8(M);v=g.l(v,M,3)}else v=v.GF(2);return v}v.C!=2&&(X=v.N)&&(r.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");c.N=O;g.ju("offlinePlaybackStarted",r);g.WF(v)})};
g.JR.prototype.BR=g.r4(45,function(c){return this.app.BR(c)});
g.Jy.prototype.BR=g.r4(44,function(c){return g.YY(this,9,c)});
g.D(ak,$k);g.Mm.Object.defineProperties(ak.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.C.entityMetadata},
set:function(c){this.C.entityMetadata=c}}});
g.D(p8k,ak);p8k.prototype.N=function(){return[]};
g.D(UNt,ak);UNt.prototype.N=function(){return[]};
g.D(CBk,ak);CBk.prototype.N=function(){return[]};
g.D(tK$,ak);tK$.prototype.N=function(){return[]};
g.D(H67,ak);H67.prototype.N=function(){var c=[];this.C.alternateChannel&&c.push(this.C.alternateChannel);this.C.alternateChannelList&&c.push.apply(c,g.Y(this.C.alternateChannelList));this.C.oneofChannelEntity&&c.push(this.C.oneofChannelEntity);return[].concat(g.Y(new Set(c)))};
g.D(lPz,ak);lPz.prototype.N=function(){var c=[];this.C.entryCollection&&c.push(this.C.entryCollection);return[].concat(g.Y(new Set(c)))};
g.D(Tws,$k);Tws.prototype.N=function(){var c=[];this.C.video&&c.push(this.C.video);return[].concat(g.Y(new Set(c)))};
g.D(ETL,ak);ETL.prototype.N=function(){var c=[];this.C.parentPlaylist&&c.push(this.C.parentPlaylist);if(this.C.entries)for(var I=g.W(this.C.entries),O=I.next();!O.done;O=I.next())c.push.apply(c,g.Y((new Tws(O.value)).N()));return[].concat(g.Y(new Set(c)))};
g.D(b6b,ak);b6b.prototype.N=function(){var c=[];this.C.descriptionEntity&&c.push(this.C.descriptionEntity);this.C.creators&&c.push.apply(c,g.Y(this.C.creators));this.C.theBiggestFan&&c.push(this.C.theBiggestFan);return[].concat(g.Y(new Set(c)))};
g.D(eUY,ak);eUY.prototype.N=function(){return[]};
g.D(FcX,ak);FcX.prototype.N=function(){return[]};
g.D($NL,ak);$NL.prototype.N=function(){return[]};
g.D(aPu,ak);aPu.prototype.N=function(){return[]};
g.D(oTL,ak);oTL.prototype.N=function(){return[]};
g.D(kDs,ak);kDs.prototype.N=function(){return[]};
g.D(Kct,ak);Kct.prototype.N=function(){return[]};
g.D(Bwz,ak);Bwz.prototype.N=function(){return[]};
g.D(St$,ak);St$.prototype.N=function(){return[]};
g.D(gTz,ak);gTz.prototype.N=function(){var c=[];this.C.downloadsList&&c.push(this.C.downloadsList);this.C.smartDownloadsList&&c.push(this.C.smartDownloadsList);this.C.recommendedDownloadsList&&c.push(this.C.recommendedDownloadsList);this.C.refresh&&c.push(this.C.refresh);return[].concat(g.Y(new Set(c)))};
g.D(fP$,$k);fP$.prototype.N=function(){var c=[];this.C.video&&c.push(this.C.video);this.C.playlist&&c.push(this.C.playlist);this.C.videoItem&&c.push(this.C.videoItem);this.C.playlistItem&&c.push(this.C.playlistItem);return[].concat(g.Y(new Set(c)))};
g.D(qtX,ak);qtX.prototype.N=function(){var c=[];this.C.refresh&&c.push(this.C.refresh);if(this.C.downloads)for(var I=g.W(this.C.downloads),O=I.next();!O.done;O=I.next())c.push.apply(c,g.Y((new fP$(O.value)).N()));return[].concat(g.Y(new Set(c)))};
g.D(w8z,ak);w8z.prototype.N=function(){var c=[];this.C.localImageEntities&&c.push.apply(c,g.Y(this.C.localImageEntities));return[].concat(g.Y(new Set(c)))};
g.D(dNt,ak);dNt.prototype.N=function(){var c=[];this.C.playbackData&&c.push(this.C.playbackData);this.C.localImageEntities&&c.push.apply(c,g.Y(this.C.localImageEntities));this.C.videoDownloadContextEntity&&c.push(this.C.videoDownloadContextEntity);return[].concat(g.Y(new Set(c)))};
g.D(RUu,ak);RUu.prototype.N=function(){return[]};
g.D(sTX,ak);sTX.prototype.N=function(){var c=[];this.C.fakeChildren&&c.push.apply(c,g.Y(this.C.fakeChildren));return[].concat(g.Y(new Set(c)))};
g.D(xN7,ak);xN7.prototype.N=function(){var c=[];this.C.video&&c.push(this.C.video);this.C.playbackData&&c.push(this.C.playbackData);this.C.offlineVideoPolicy&&c.push(this.C.offlineVideoPolicy);return[].concat(g.Y(new Set(c)))};
g.D(Z6L,ak);Z6L.prototype.N=function(){return[]};
g.D(zUt,ak);zUt.prototype.N=function(){var c=[];this.C.channelOwner&&c.push(this.C.channelOwner);this.C.videos&&c.push.apply(c,g.Y(this.C.videos));this.C.collaboratorChannels&&c.push.apply(c,g.Y(this.C.collaboratorChannels));this.C.downloadState&&c.push(this.C.downloadState);this.C.refresh&&c.push(this.C.refresh);return[].concat(g.Y(new Set(c)))};
g.D(QTt,ak);QTt.prototype.N=function(){var c=[];this.C.video&&c.push(this.C.video);this.C.channelContributor&&c.push(this.C.channelContributor);return[].concat(g.Y(new Set(c)))};
g.D(cVL,$k);cVL.prototype.N=function(){var c=[];this.C.localImageEntities&&c.push.apply(c,g.Y(this.C.localImageEntities));this.C.videoDownloadContextEntity&&c.push(this.C.videoDownloadContextEntity);return[].concat(g.Y(new Set(c)))};
g.D(I_k,$k);I_k.prototype.N=function(){var c=[];this.C.recommendedVideoMetadata&&c.push.apply(c,g.Y((new cVL(this.C.recommendedVideoMetadata)).N()));return[].concat(g.Y(new Set(c)))};
g.D(OkY,$k);OkY.prototype.N=function(){var c=[];this.C.playbackPosition&&c.push(this.C.playbackPosition);return[].concat(g.Y(new Set(c)))};
g.D(rVk,ak);rVk.prototype.N=function(){var c=[];this.C.owner&&c.push(this.C.owner);this.C.downloadState&&c.push(this.C.downloadState);this.C.userState&&c.push.apply(c,g.Y((new OkY(this.C.userState)).N()));this.C.additionalMetadata&&c.push.apply(c,g.Y((new I_k(this.C.additionalMetadata)).N()));return[].concat(g.Y(new Set(c)))};
g.D(u4X,ak);u4X.prototype.N=function(){var c=[];this.C.userChannelDetails&&c.push(this.C.userChannelDetails);return[].concat(g.Y(new Set(c)))};
g.D(XoX,ak);XoX.prototype.N=function(){var c=[];this.C.channelOwner&&c.push(this.C.channelOwner);this.C.playbackPosition&&c.push(this.C.playbackPosition);this.C.localImageEntities&&c.push.apply(c,g.Y(this.C.localImageEntities));this.C.downloadStatus&&c.push(this.C.downloadStatus);return[].concat(g.Y(new Set(c)))};
g.D(vxa,ak);vxa.prototype.N=function(){return[]};
g.D(P9Y,ak);P9Y.prototype.N=function(){return[]};
g.D(M77,ak);M77.prototype.N=function(){return[]};
g.D(ikb,ak);ikb.prototype.N=function(){return[]};
g.D(Gks,ak);Gks.prototype.N=function(){return[]};
g.D(jbO,ak);jbO.prototype.N=function(){return[]};
g.D(my$,ak);my$.prototype.N=function(){return[]};
g.D(nxs,ak);nxs.prototype.N=function(){return[]};
g.D(hrO,ak);hrO.prototype.N=function(){return[]};
g.D(V7k,ak);V7k.prototype.N=function(){return[]};
g.D(AVX,ak);AVX.prototype.N=function(){return[]};
g.D(NsX,ak);NsX.prototype.N=function(){var c=[];this.C.trackDownloadMetadatas&&c.push.apply(c,g.Y(this.C.trackDownloadMetadatas));return[].concat(g.Y(new Set(c)))};
g.D(Dyu,ak);
Dyu.prototype.N=function(){var c=[];this.C.downloadedTracks&&c.push.apply(c,g.Y(this.C.downloadedTracks));this.C.smartDownloadedTracks&&c.push.apply(c,g.Y(this.C.smartDownloadedTracks));this.C.downloadedEpisodes&&c.push.apply(c,g.Y(this.C.downloadedEpisodes));this.C.downloadedAlbumReleases&&c.push.apply(c,g.Y(this.C.downloadedAlbumReleases));this.C.smartDownloadedAlbumReleases&&c.push.apply(c,g.Y(this.C.smartDownloadedAlbumReleases));this.C.downloadedPlaylists&&c.push.apply(c,g.Y(this.C.downloadedPlaylists));this.C.smartDownloadedPlaylists&&
c.push.apply(c,g.Y(this.C.smartDownloadedPlaylists));this.C.metadataOnlyTracks&&c.push.apply(c,g.Y(this.C.metadataOnlyTracks));return[].concat(g.Y(new Set(c)))};
g.D(WSz,ak);WSz.prototype.N=function(){var c=[];this.C.trackDownloadMetadatas&&c.push.apply(c,g.Y(this.C.trackDownloadMetadatas));return[].concat(g.Y(new Set(c)))};
g.D(yV7,ak);yV7.prototype.N=function(){var c=[];this.C.playbackData&&c.push(this.C.playbackData);this.C.localImageEntities&&c.push.apply(c,g.Y(this.C.localImageEntities));this.C.videoDownloadContextEntity&&c.push(this.C.videoDownloadContextEntity);return[].concat(g.Y(new Set(c)))};
g.D(JVk,ak);JVk.prototype.N=function(){var c=[];this.C.musicLibraryStatusEntity&&c.push(this.C.musicLibraryStatusEntity);this.C.primaryArtists&&c.push.apply(c,g.Y(this.C.primaryArtists));this.C.details&&c.push(this.C.details);this.C.userDetails&&c.push(this.C.userDetails);this.C.tracks&&c.push.apply(c,g.Y(this.C.tracks));this.C.share&&c.push(this.C.share);this.C.downloadMetadata&&c.push(this.C.downloadMetadata);this.C.refresh&&c.push(this.C.refresh);return[].concat(g.Y(new Set(c)))};
g.D(YRk,ak);YRk.prototype.N=function(){var c=[];this.C.albumRelease&&c.push(this.C.albumRelease);this.C.tracks&&c.push.apply(c,g.Y(this.C.tracks));return[].concat(g.Y(new Set(c)))};
g.D(LSs,ak);LSs.prototype.N=function(){var c=[];this.C.albumRelease&&c.push(this.C.albumRelease);return[].concat(g.Y(new Set(c)))};
g.D(pos,ak);pos.prototype.N=function(){var c=[];this.C.details&&c.push(this.C.details);this.C.userDetails&&c.push(this.C.userDetails);return[].concat(g.Y(new Set(c)))};
g.D(UyX,ak);UyX.prototype.N=function(){var c=[];this.C.parentArtist&&c.push(this.C.parentArtist);return[].concat(g.Y(new Set(c)))};
g.D(C9a,ak);C9a.prototype.N=function(){var c=[];this.C.parentArtist&&c.push(this.C.parentArtist);return[].concat(g.Y(new Set(c)))};
g.D(t7k,ak);t7k.prototype.N=function(){return[]};
g.D(Hkz,ak);Hkz.prototype.N=function(){return[]};
g.D(l_b,$k);l_b.prototype.N=function(){var c=[];this.C.creatorEntity&&c.push(this.C.creatorEntity);return[].concat(g.Y(new Set(c)))};
g.D(Ts7,ak);
Ts7.prototype.N=function(){var c=[];this.C.tracks&&c.push.apply(c,g.Y(this.C.tracks));this.C.refresh&&c.push(this.C.refresh);this.C.musicLibraryStatusEntity&&c.push(this.C.musicLibraryStatusEntity);this.C.details&&c.push(this.C.details);this.C.downloadMetadata&&c.push(this.C.downloadMetadata);this.C.sideloadMetadata&&c.push(this.C.sideloadMetadata);this.C.userDetails&&c.push(this.C.userDetails);this.C.entryCollection&&c.push(this.C.entryCollection);this.C.share&&c.push(this.C.share);this.C.podcastShowAdditionalMetadata&&c.push.apply(c,
g.Y((new l_b(this.C.podcastShowAdditionalMetadata)).N()));return[].concat(g.Y(new Set(c)))};
g.D(Exu,ak);Exu.prototype.N=function(){return[]};
g.D(bku,ak);
bku.prototype.N=function(){var c=[];this.C.musicLibraryStatusEntity&&c.push(this.C.musicLibraryStatusEntity);this.C.artists&&c.push.apply(c,g.Y(this.C.artists));this.C.audioModeVersion&&c.push(this.C.audioModeVersion);this.C.videoModeVersion&&c.push(this.C.videoModeVersion);this.C.userDetails&&c.push(this.C.userDetails);this.C.details&&c.push(this.C.details);this.C.albumRelease&&c.push(this.C.albumRelease);this.C.share&&c.push(this.C.share);this.C.libraryEdit&&c.push(this.C.libraryEdit);this.C.downloadMetadata&&
c.push(this.C.downloadMetadata);this.C.playbackPosition&&c.push(this.C.playbackPosition);this.C.lyrics&&c.push(this.C.lyrics);return[].concat(g.Y(new Set(c)))};
g.D(ers,ak);ers.prototype.N=function(){var c=[];this.C.parentTrack&&c.push(this.C.parentTrack);return[].concat(g.Y(new Set(c)))};
g.D(FSO,ak);FSO.prototype.N=function(){var c=[];this.C.parentTrack&&c.push(this.C.parentTrack);return[].concat(g.Y(new Set(c)))};
g.D($yk,ak);$yk.prototype.N=function(){return[]};
g.D(a_L,ak);a_L.prototype.N=function(){return[]};
g.D(oxt,ak);oxt.prototype.N=function(){return[]};
g.D(kkk,ak);kkk.prototype.N=function(){return[]};
g.D(KSs,ak);KSs.prototype.N=function(){var c=[];this.C.transfer&&c.push(this.C.transfer);this.C.adsPlaybackData&&c.push.apply(c,g.Y(this.C.adsPlaybackData));this.C.drmLicense&&c.push(this.C.drmLicense);this.C.offlineVideoPolicy&&c.push(this.C.offlineVideoPolicy);this.C.videoDownloadContextEntity&&c.push(this.C.videoDownloadContextEntity);return[].concat(g.Y(new Set(c)))};
g.D(Bs7,ak);Bs7.prototype.N=function(){return[]};
g.D(SR7,ak);SR7.prototype.N=function(){var c=[];this.C.offlineVideoStreams&&c.push.apply(c,g.Y(this.C.offlineVideoStreams));this.C.captionTrack&&c.push.apply(c,g.Y(this.C.captionTrack));return[].concat(g.Y(new Set(c)))};
g.D(gx7,ak);gx7.prototype.N=function(){return[]};
g.D(f_a,ak);f_a.prototype.N=function(){return[]};
g.D(qRL,ak);qRL.prototype.N=function(){return[]};
g.D(woL,ak);woL.prototype.N=function(){return[]};
g.D(dys,ak);dys.prototype.N=function(){return[]};
g.D(Rru,ak);Rru.prototype.N=function(){return[]};
g.D(sbL,ak);sbL.prototype.N=function(){return[]};
g.D(xyz,ak);xyz.prototype.N=function(){return[]};
g.D(ZkX,ak);ZkX.prototype.N=function(){return[]};
g.D(zrt,ak);zrt.prototype.N=function(){return[]};
g.D(Qbk,ak);Qbk.prototype.N=function(){return[]};
g.D(cbb,ak);cbb.prototype.N=function(){return[]};
g.D(INk,ak);INk.prototype.N=function(){return[]};
g.D(OgO,ak);OgO.prototype.N=function(){return[]};
g.D(rbs,ak);rbs.prototype.N=function(){return[]};
g.D(u_7,ak);u_7.prototype.N=function(){return[]};
g.D(Xhk,ak);Xhk.prototype.N=function(){return[]};
g.D(v5s,ak);v5s.prototype.N=function(){return[]};
var rdL=["browse","music/browse","unplugged/browse"],MZs=["offline/playlist_sync_check"],Ryu=["offline"],u$L=["offline/offline_video_playback_position_sync"],vn$=["offline/get_playback_data_entity"],ok;kk.getInstance=function(){return g.E(function(c){return c.return(new Promise(function(I){g.cl().then(function(O){O?(kk.instance||(kk.instance=new kk(O)),I(kk.instance)):I(void 0)})}))})};
kk.prototype.get=function(c){var I=this,O,r,u;return g.E(function(X){if(X.C==1)return g.l(X,GGa(I.token),2);if(X.C!=3)return O=X.N,g.l(X,O.get("prefs",c),3);r=X.N;if(!r)return X.return();u=(0,g.lq)();return r.expirationTimestampMs<=u?X.return():X.return(r.value)})};
kk.prototype.set=function(c,I,O){O=O===void 0?31536E3:O;var r=this,u,X,v;return g.E(function(M){if(M.C==1)return u=(0,g.lq)(),X={key:c,value:I,expirationTimestampMs:u+O*1E3},g.l(M,GGa(r.token),2);v=M.N;return g.l(M,g.$s(v,"prefs",X),0)})};
kk.prototype.remove=function(c){var I=this,O;return g.E(function(r){if(r.C==1)return g.l(r,GGa(I.token),2);O=r.N;return g.l(r,O.delete("prefs",c),0)})};
g.D(K$,g.sZ);g.D(Bm,VHa);Bm.prototype.W=function(c,I){I=NHz(I);c=(new TextEncoder).encode(JSON.stringify(c));return this.C.encrypt(c,I)};
Bm.prototype.N=function(c,I){if(!(c instanceof Uint8Array))throw jpu(1);var O=new TextDecoder;I=NHz(I);c=this.C.decrypt(c,I);return JSON.parse(O.decode(c))};
var Dn$={accountLinkStatusEntity:$NL,booleanEntity:CBk,buttonEntity:Qbk,captionTrack:$yk,channelHandle:p8k,commerceAcquisitionClientPayloadEntity:INk,commerceCartListEntity:OgO,contextNoteFeedEntityPayload:UNt,continuationTokenEntity:Z6L,downloadQualityPickerEntity:Kct,downloadsPageRefreshTokenEntity:St$,downloadsPageViewConfigurationEntity:vxa,downloadStatusEntity:Bwz,dismissState:dys,sfvAudioItemCurrentlyPlayingEntity:f_a,emojiFountainDataEntity:ZkX,emojiCustomizationSetEntity:xyz,fakeChannel:H67,
fakePlaylist:lPz,fakePlaylistEntryCollection:ETL,fakeVideo:b6b,fakeVideoDescription:eUY,featuredProductsEntity:hrO,flowStateEntity:FcX,iconBadgeEntity:rbs,interstitialInteractionStateEntity:oTL,likeButtonAnimationEntity:P9Y,liveChatPollStateEntity:kDs,liveReactionsDataEntity:zrt,logoEntity:aPu,macroMarkerEntity:M77,mainDownloadsLibraryEntity:gTz,mainDownloadsListEntity:qtX,mainPlaylistDownloadStateEntity:w8z,mainPlaylistEntity:zUt,mainPlaylistVideoEntity:QTt,mainVideoDownloadStateEntity:dNt,mainVideoEntity:rVk,
markersEngagementPanelSyncEntity:ikb,markersVisibilityOverrideEntity:Gks,musicAlbumReleaseDetail:YRk,musicAlbumReleaseDownloadMetadataEntity:NsX,musicAlbumRelease:JVk,musicAlbumReleaseUserDetail:LSs,musicArtistDetail:UyX,musicArtist:pos,musicArtistUserDetail:C9a,musicDownloadsLibraryEntity:Dyu,musicLibraryEdit:t7k,musicLibraryStatusEntity:Hkz,musicPlaylist:Ts7,musicPlaylistDownloadMetadataEntity:WSz,musicShare:Exu,musicTrackDetail:ers,musicTrackDownloadMetadataEntity:yV7,musicTrack:bku,musicTrackUserDetail:FSO,
offlineOrchestrationActionWrapperEntity:a_L,offlineVideoPolicy:oxt,offlineVideoStreams:kkk,offlineabilityEntity:RUu,orchestrationWebSamplingEntity:sTX,pageHeaderEntity:Rru,pdpStateEntity:u_7,pinnedProductEntity:V7k,playbackData:KSs,playerStateEntity:jbO,quantityIncrementerEntity:Xhk,refresh:Bs7,saveToPlaylistListEntity:qRL,settingEntity:woL,stringEntity:tK$,suggestedFeedbackChipStateEntity:my$,transfer:SR7,trendingOfferEntity:AVX,videoDownloadContextEntity:gx7,videoOverviewAsyncDataEntity:v5s,videoPlaybackPositionEntity:cbb,
votingEntity:sbL,ytMainChannelEntity:u4X,youchatPendingResponseEntity:nxs,ytMainDownloadedVideoEntity:xN7,ytMainVideoEntity:XoX};g.D(d0,VHa);d0.prototype.W=function(c){return c};
d0.prototype.N=function(c){if(c instanceof Uint8Array)throw jpu(0);return c};
g.D(Rk,g.k);Rk.prototype.observe=function(c){var I=this;this.observers.push(c);return function(){var O=I.observers.indexOf(c);O>=0&&I.observers.splice(O,1)}};
Rk.prototype.N=function(c){bgs(this,c.data)};
Rk.prototype.W0=function(){this.channel.close()};
var o5k,eyL=new g.l5("elementsCommand");var pI=new g.l5("entityBatchUpdate");var J_O=new g.l5("downloadStatusEntity");var oFb=new g.l5("mainPlaylistEntityActionMetadata");var x4=new g.l5("mainVideoEntityActionMetadata");var d8u=new g.l5("musicPlaylistEntityActionMetadata");var DpX=new g.l5("musicTrackEntityActionMetadata");var Q6k=new g.l5("localImageEntityActionMetadata");var $4=new g.l5("playbackDataActionMetadata");var FjL=new g.l5("transferEntityActionMetadata");var Wjb=new g.l5("videoPlaybackPositionEntityActionMetadata");var QpY;new g.Am;new g.Am;ubu.prototype.request=function(c,I,O){I=I===void 0?{}:I;return this.locks.request(c,I,function(r){return O(r)})};var rD=g.kU.caches,Of,ita;IP.prototype.open=function(c){return rD.open(Puz(c))};
IP.prototype.has=function(c){return rD.has(Puz(c))};
IP.prototype.delete=function(c){return rD.delete(Puz(c))};
IP.prototype.match=function(c,I){var O=this,r,u,X,v,M,G;return g.E(function(m){switch(m.C){case 1:return g.l(m,O.keys(),2);case 2:r=m.N,u=g.W(r),X=u.next();case 3:if(X.done){m.GF(5);break}v=X.value;return g.l(m,O.open(v),6);case 6:return M=m.N,g.l(m,M.match(c,I),7);case 7:if(G=m.N)return m.return(G);X=u.next();m.GF(3);break;case 5:return m.return()}})};
g.D(vtz,IP);vtz.prototype.keys=function(){var c,I,O,r,u,X,v,M,G;return g.E(function(m){if(m.C==1)return c=[],I=g.x1("CacheStorage keys"),g.l(m,rD.keys(),2);O=m.N;r=g.W(O);for(u=r.next();!u.done;u=r.next()){X=u.value;var n=X.indexOf(":");v=n===-1?{un:X}:{un:X.substring(0,n),datasyncId:X.substring(n+1)};M=v.un;G=v.datasyncId;G===I&&c.push(M)}return m.return(c)})};g.D(Xr,g.k);Xr.prototype.W=function(c){this.api.XV("onOfflineOperationFailure",c.data)};
Xr.prototype.Y=function(c){this.api.publish("offlinetransferpause",c.data)};
Xr.prototype.W0=function(){var c;(c=this.C)==null||c.close();var I;(I=this.N)==null||I.close()};m87.prototype.Ng=function(){this.C&&Py(this)};
m87.prototype.KW=function(){this.N&&this.N.resolve();this.W=this.C=!1;this.j()};var ZQ7=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var TJX="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var S0k="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.D(GNt,bj);GNt.prototype.N=function(c){return jD(c)?nns(this,c):mY(c)?AdY(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};g.D(NFY,bj);NFY.prototype.N=function(c){return mY(c)?Dcs(this,c):y_L(c)?ydX(this,c):nI(c)?JdX(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};g.P=Y1Y.prototype;g.P.SzB=function(c){var I=this,O,r,u,X;return g.E(function(v){if(!g.x(c.state,128))return v.GF(0);O=c.state.In;var M=(r=O)==null?void 0:r.errorCode,G=(u=O)==null?void 0:u.E9;X=M==="net.connect"&&G===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(M==null?0:M.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.l(v,I.hO(I.player.getVideoData().videoId,X),0)})};
g.P.hO=function(c,I){var O=this;return g.E(function(r){if(r.C==1){if(O.N)return r.return();O.N=!0;return I==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(k4(O,c,!1,!0),r.GF(0)):g.l(r,oP(O,c),3)}g.Cd(c,4);return g.l(r,O.C.hO(I),0)})};
g.P.gq=function(c){c.status===2?(c.status!==this.W&&(DQ$(this.C),g.Cd(c.videoId,2)),c.Nx&&L8O(this.C,c.videoId,c.Nx)):c.status===4?(oP(this,c.videoId),this.hO(c.videoId,c.Gt?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):c.status===1&&Y6O(this.C);this.W=c.status;this.api.XV("localmediachange",{videoId:c.videoId,status:c.status})};
g.P.K7=function(){var c=this,I;return g.E(function(O){if(O.C==1){if(c.N)return O.return();c.N=!0;I=c.player.getVideoData().videoId;return g.l(O,oP(c,I),2)}return g.l(O,c.C.K7(),0)})};
g.P.Q5=function(c){switch(c){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.P.B=function(c){return this.api.J().B(c)};g.D(lcL,bj);lcL.prototype.N=function(c){return jD(c)?EnO(this,c):mY(c)?bQs(this,c):y_L(c)?esL(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};Kjs.prototype.C=function(c,I){var O=c.action.actionMetadata.priority-I.action.actionMetadata.priority;O===0&&(c.C<I.C?O=-1:c.C>I.C&&(O=1));return O};g.D(KI,g.k);KI.prototype.W0=function(){this.j&&this.j();g.k.prototype.W0.call(this)};
KI.prototype.createAction=function(c,I){var O=g.Pe(c.entityKey).entityType,r=g.pR(16);return new DD(O,r,c,I.actionId,I.rootActionId)};
KI.prototype.nV=function(c){var I=this,O,r,u,X,v,M,G,m,n;return g.E(function(h){if(h.C==1){if(I.lq())return h.return();r=(O=c.offlineOrchestrationActionWrapperEntity)!=null?O:new Set;u=[];X=g.W(r);for(v=X.next();!v.done;v=X.next())M=v.value,G=g.Pe(M),m=G.entityId,gnb(I.C,m)||u.push(M);return g.l(h,cFb(I,u),2)}n=h.N;return g.l(h,Q9X(I,n),0)})};
KI.prototype.retry=function(){var c=this;return g.E(function(I){return g.l(I,IQs(c),0)})};rF7.prototype.t0=function(c,I){I=I===void 0?!0:I;var O=this,r,u,X,v,M,G,m,n;return g.E(function(h){switch(h.C){case 1:if(!O.C)return h.return();r=[];u=g.VF(O.C.N,I);X=[];for(v={gF:0};v.gF<u.length;v={gF:v.gF},v.gF++)M=u[v.gF],G=O.C.fz(M,"json3"),m=g.b3(G,{withCredentials:!0,format:"RAW"},3,500).then(function(V){return function(A){A={metadata:g.jM(u[V.gF]),trackData:A.xhr.responseText};X.push(A)}}(v)).uA(function(V){uj("Caption fetch error",V)}),r.push(m);
return g.l(h,Lc7(r),2);case 2:return g.yy(h,3),g.l(h,whY(c,X),5);case 5:g.YU(h,0);break;case 3:n=g.Lz(h),uj("Caption DB transaction error",n),g.WF(h)}})};g.D(By,g.k);By.prototype.W0=function(){this.N&&this.N();g.k.prototype.W0.call(this)};
By.prototype.W=function(c){var I=this,O,r,u,X,v,M,G,m;return g.E(function(n){r=(O=c.transfer)!=null?O:new Set;u=[];X=g.W(r);for(v=X.next();!v.done;v=X.next())M=v.value,G=g.Pe(M),m=G.entityId,u.push(m);return u.length===0?n.return():g.l(n,vF$(I,u),0)})};g.D(j6a,g.k);g.P=j6a.prototype;g.P.W0=function(){this.x$&&this.x$();this.Sf.dispose();this.Y.dispose();this.LV&&g.Kh(this.G.By,this.LV);this.B0&&g.Kh(this.G.By,this.B0);g.k.prototype.W0.call(this)};
g.P.REi=function(c){var I=this,O,r,u;return g.E(function(X){switch(X.C){case 1:O=g.MA(c,"transfer");if(I.C&&O===I.C.key){k4(I.V,I.L,!0);I.Y.stop();X.GF(0);break}return g.l(X,xk(I.N,{mode:"readwrite",Zw:!0},function(v){return Si(v,O,"transfer").then(function(M){if(M&&M.transferState!=="TRANSFER_STATE_COMPLETE"&&M.transferState!=="TRANSFER_STATE_FAILED")return M.transferState="TRANSFER_STATE_PAUSED_BY_USER",qu(v,M,"transfer").then(function(){return M})})}),3);
case 3:r=X.N;if(!r){X.GF(0);break}if(!c||!I.W){X.GF(5);break}return g.l(X,hn(c,I.W,I.N,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.l(X,fI(I,c),7);case 7:u=X.N,D8O({videoId:c,Nb:r,offlineModeType:u}),g.WF(X)}})};
g.P.ZDB=function(){var c=this;if(this.C&&this.L){k4(this.V,this.L,!1);var I=this.C,O=(I==null?0:I.key)?g.Pe(I.key).entityId:"";O&&this.W&&(new Promise(function(r,u){hn(O,c.W,c.N,"DOWNLOAD_STATE_PAUSED").catch(function(X){u(X)})})).catch(function(r){uj("Download state setting error",r)})}this.Y.stop()};
g.P.eO=function(){this.C?h_a(this,this.C):gD(this)};
g.P.IG=function(c){var I=this;return g.E(function(O){switch(O.C){case 1:if(!I.C){O.GF(2);break}if(I.C.transferState==="TRANSFER_STATE_COMPLETE"||I.C.transferState==="TRANSFER_STATE_FAILED"||!c.transfer||!c.transfer.has(I.C.key)){O.GF(3);break}return g.l(O,zK(I.N,I.C.key,"transfer"),4);case 4:I.C=O.N;if(I.C){O.GF(3);break}return g.l(O,V4s(I),3);case 3:if(I.C)return O.return();case 2:return g.l(O,gD(I),0)}})};
g.P.hO=function(c,I){var O=this,r,u,X,v,M;return g.E(function(G){switch(G.C){case 1:if(!O.C){q7(O,"onTransferFailure: "+c);G.GF(2);break}r=O.C;X=((u=r)==null?0:u.key)?g.Pe(r.key).entityId:"";a:switch(c){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var m=!1;break a;default:m=!0}return m&&ptO(O)?g.l(G,wD(O,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.l(G,
UQs(O,c),5);case 5:if(!X||!O.W){G.GF(2);break}return g.l(G,hn(X,O.W,O.N,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.l(G,fI(O,X),9);case 9:v=G.N;ij({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:X,Nb:r,offlineModeType:v});if(!X||!O.W){G.GF(2);break}return g.l(G,hn(X,O.W,O.N,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:SD(O),M=gD(O,!0),I&&I(M),g.WF(G)}})};
g.P.K7=function(c){var I=this,O,r,u,X,v,M,G,m,n,h,V,A;return g.E(function(N){switch(N.C){case 1:if(!I.C){q7(I,"onMaybeTransferStreamsExpired");N.GF(2);break}return ptO(I)?g.l(N,wD(I,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.l(N,UQs(I,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!I.W){N.GF(2);break}O=I.C;u=((r=O)==null?0:r.key)?g.Pe(O.key).entityId:"";if(!u){N.GF(2);break}return g.l(N,hn(u,I.W,I.N,"DOWNLOAD_STATE_FAILED"),2);case 9:return I.C||q7(I,"onMaybeTransferStreamsExpiredRetryAttempting"),
X=I.C,M=((v=X)==null?0:v.key)?g.Pe(X.key).entityId:"",g.l(N,fI(I,M),10);case 10:return G=N.N,ij({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:M,Nb:X,offlineModeType:G}),m=p6$(),g.B4(m,$4,{isEnqueuedForExpiredStreamUrlRefetch:!0}),n=g.MA(M,"playbackData"),h={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:n,actionMetadata:m},V=yc(new DD("playbackData",M,h)),g.l(N,Z$(I.N,V,"offlineOrchestrationActionWrapperEntity"),2);case 2:SD(I),A=gD(I,!0),
c&&c(A),g.WF(N)}})};
var ljt={},C$k=(ljt.TRANSFER_STATE_TRANSFERRING=1,ljt.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,ljt);g.P=dD.prototype;g.P.xM=function(){return this.L.promise};
g.P.Xa=function(){if(this.N&&this.V)return this.L.promise;lQt(this).then(this.L.resolve).catch(this.L.reject);return this.L.promise};
g.P.yS=function(c){var I={};return I.playbackData=new GNt(c,this.uq,this.C),I.transfer=new lcL(c,this.uq),I.videoPlaybackPositionEntity=new NFY(c,this.uq),I};
g.P.Np=function(){var c=this;return g.E(function(I){return c.N?g.l(I,mQk(c.N),0):I.GF(0)})};
g.P.i4=function(){var c=this,I,O;return g.E(function(r){if(r.C==1)return c.N||c.V?g.l(r,c.xM(),2):r.return();c.K!==void 0&&(g.JM(c.K),c.K=void 0);c.Y!==void 0&&(g.JM(c.Y),c.Y=void 0);(I=c.N)==null||I.dispose();c.N=void 0;(O=c.V)==null||O.dispose();c.V=void 0;c.api.XV("onOrchestrationLostLeader");c.L=new g.Am;g.WF(r)})};
g.P.isOrchestrationLeader=function(){return this.W.C};
g.P.k8=function(){return g.E(function(c){return c.return(!1)})};
g.P.H1=function(c){var I=this.C;I.api.publish("offlinetransferpause",c);var O;(O=I.N)==null||O.postMessage(c)};
g.P.eO=function(c){var I,O;return g.E(function(r){if(r.C==1)return g.l(r,cy(),2);I=r.N;if(!I)return r.return();O=g.MA(c,"transfer");return g.l(r,xk(I,{mode:"readwrite",Zw:!0},function(u){var X=Si(u,O,"transfer"),v=Si(u,g.MA(c,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.U2.all([X,v]).then(function(M){M=g.W(M);var G=M.next().value;var m=M.next().value;return G&&G.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(G.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",qu(u,G,"transfer").then(function(){ij({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:c,Nb:G,offlineModeType:m==null?void 0:m.offlineModeType});return g.U2.resolve(null)})):g.U2.resolve(null)})}),0)})};
g.P.Oi=function(c){c=c===void 0?43200:c;var I=this,O,r,u,X,v,M,G,m;return g.E(function(n){if(n.C==1)return I.G.Vf()?g.l(n,cy(),2):n.return(TCL());if(n.C!=3){O=n.N;if(!O)return n.return([]);r=Date.now()/1E3;return g.l(n,Qp(O,"offlineVideoPolicy"),3)}u=n.N;X=[];v=g.W(u);for(M=v.next();!M.done;M=v.next())G=M.value,Number(G.lastUpdatedTimestampSeconds)+c<=r&&(m=g.Pe(G.key).entityId,X.push(m));return X.length?n.return(RP(I,X,I.j,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):n.return([])})};
g.P.deleteAll=function(){return RP(this,["!*$_ALL_ENTITIES_!*$"],this.j,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.P.refreshAllStaleEntities=function(c){var I=this;return g.E(function(O){return O.C==1?g.l(O,I.Oi(c),2):O.return(O.N)})};
g.P.setUpPositionSyncInterval=function(c){var I=this;this.Y!==void 0&&(g.JM(this.Y),this.Y=void 0);var O=c!=null?c:864E5;this.Y=g.WJ(function(){I.oB(O)},O)};
g.P.oB=function(c){var I=this,O,r,u,X,v,M;return g.E(function(G){switch(G.C){case 1:return g.yy(G,2),g.l(G,kk.getInstance(),4);case 4:O=G.N;if(!O)throw Error("prefStorage is undefined");return g.l(G,O.get("psi"),5);case 5:r=G.N;X=((u=r)==null?0:u.a6)?Number(r.a6)/1E3:0;v=Date.now();if(!(X+c<=v)){G.GF(6);break}return g.l(G,RP(I,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.YU(G,0);break;case 2:M=g.Lz(G),uj("Offline manager error",M),
g.WF(G)}})};
g.P.C1=function(){var c=this,I,O,r,u,X,v,M;return g.E(function(G){if(G.C==1)return g.l(G,cy(),2);if(G.C!=3)return(I=G.N)?g.l(G,Qp(I,"transfer"),3):G.return([]);O=G.N;r=[];u=g.W(O);for(X=u.next();!X.done;X=u.next())v=X.value,v.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&v.key&&(M=g.Pe(v.key).entityId,r.push(M));return G.return(bqY(c,r))})};
g.P.aD=function(){return g.E(function(c){return c.return([])})};
g.P.N9=function(){return g.E(function(c){g.WF(c)})};
g.P.SF=function(){return g.E(function(c){g.WF(c)})};g.D(e_k,bj);e_k.prototype.N=function(c){return jD(c)?aQk(this,c):mY(c)?kua(this,c):nI(c)?K8k(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};
var sf=[10];g.D(q6a,bj);q6a.prototype.N=function(c){return jD(c)?R_$(this,c):mY(c)?s6O(this,c):nI(c)?xQk(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};
var dQb=[10];g.D(z_7,bj);z_7.prototype.N=function(c){return mY(c)?c9$(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};g.D(Iju,dD);g.P=Iju.prototype;g.P.yS=function(c){var I=dD.prototype.yS.call(this,c);I.mainVideoEntity=new q6a(c,this.uq,this.C);I.mainPlaylistEntity=new e_k(c,this.uq,this.C);I.mainDownloadsListEntity=new z_7(c,this.uq,this.C);return I};
g.P.refreshAllStaleEntities=function(c,I){var O=this,r,u,X,v,M,G,m,n,h,V,A;return g.E(function(N){switch(N.C){case 1:r=[];if(!O.uq.B("web_player_offline_playlist_auto_refresh")){N.GF(2);break}return g.l(N,Ooz(O,c,I),3);case 3:r=N.N;case 2:return g.l(N,kk.getInstance(),4);case 4:return u=N.N,g.l(N,(X=u)==null?void 0:X.get("sdois"),5);case 5:return v=N.N,g.l(N,(M=u)==null?void 0:M.get("lmqf"),6);case 6:G=N.N;if(!v){N.GF(7);break}n=r;h=n.concat;return g.l(N,r9k(O,v,(m=G)!=null?m:"SD",c===0),8);case 8:r=
h.call(n,N.N);case 7:return V=r,A=V.concat,g.l(N,dD.prototype.refreshAllStaleEntities.call(O,c,I),9);case 9:return r=A.call(V,N.N),N.return(r)}})};
g.P.k8=function(c){var I,O,r,u,X,v,M,G;return g.E(function(m){if(m.C==1)return g.l(m,cy(),2);if(m.C!=3)return(I=m.N)?g.l(m,zK(I,g.$c,"mainDownloadsListEntity"),3):m.return(!1);O=m.N;if((r=O)==null?0:(u=r.downloads)==null?0:u.length)for(X=g.MA(c,"mainVideoEntity"),v=g.W(O.downloads),M=v.next();!M.done;M=v.next())if(G=M.value,G.videoItem===X)return m.return(!0);return m.return(!1)})};
g.P.aD=function(){var c=this,I,O,r,u,X,v,M,G;return g.E(function(m){if(m.C==1)return g.l(m,cy(),2);if(m.C!=3)return(I=m.N)?g.l(m,Qp(I,"downloadStatusEntity"),3):m.return([]);O=m.N;r=[];u=g.W(O);for(X=u.next();!X.done;X=u.next())v=X.value,v.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&v.key&&(M=g.Pe(v.key).entityId,r.push(M));return r.length?(G={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},m.return(RP(c,r,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
G))):m.return([])})};
g.P.SF=function(){var c;return g.E(function(I){return I.C==1?g.l(I,cy(),2):(c=I.N)?g.l(I,xk(c,{mode:"readwrite",Zw:!0},function(O){return g0(O,"mainVideoEntity").then(function(r){var u=[];r=g.W(r);for(var X=r.next();!X.done;X=r.next()){X=X.value;var v=void 0;(v=X.userState)!=null&&v.playbackPosition||(v=g.Pe(X.key).entityId,v={key:g.MA(v,"videoPlaybackPositionEntity"),videoId:v,lastPlaybackPositionSeconds:"0"},u.push(qu(O,v,"videoPlaybackPositionEntity")),X.userState={playbackPosition:v.key},u.push(qu(O,
X,"mainVideoEntity")))}return g.U2.all(u)})}),0):I.return()})};
g.P.N9=function(){var c,I,O,r,u,X,v,M,G,m,n,h,V,A,N,J,L,U,t,T,a,K,R,d,uF,PF,cF,f,Q,y,q,BF,Ju,mk,tf,Zv,rL,Au;return g.E(function(p){if(p.C==1)return g.l(p,cy(),2);if(p.C!=3){c=p.N;if(!c)return p.return();I=g.MA("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.l(p,xk(c,{mode:"readonly",Zw:!0},function(C){return g.U2.all([Si(C,I,"mainDownloadsListEntity"),Si(C,g.$c,"mainDownloadsListEntity"),g0(C,"mainVideoEntity"),g0(C,"mainPlaylistEntity")])}),3)}O=p.N;
r=g.W(O);u=r.next().value;X=r.next().value;v=r.next().value;M=r.next().value;G=u;m=X;n=v;h=M;V=new Set;if((A=G)==null?0:(N=A.downloads)==null?0:N.length)for(J=g.W(G.downloads),L=J.next();!L.done;L=J.next())U=L.value,t=void 0,(T=(t=U.videoItem)!=null?t:U.playlistItem)&&V.add(T);if((a=m)==null?0:(K=a.downloads)==null?0:K.length)for(R=g.W(m.downloads),d=R.next();!d.done;d=R.next())uF=d.value,uF.videoItem&&V.add(uF.videoItem);PF=new Set;cF=[];f=g.W(h);for(Q=f.next();!Q.done;Q=f.next()){y=Q.value;if(y.videos)for(q=
g.W(y.videos),BF=q.next();!BF.done;BF=q.next())Ju=BF.value,(mk=JSON.parse(g.Pe(Ju).entityId).videoId)&&PF.add(mk);y.key&&!V.has(y.key)&&cF.push(y.key)}tf=g.W(n);for(Zv=tf.next();!Zv.done;Zv=tf.next())rL=Zv.value,rL.key&&!V.has(rL.key)&&(Au=g.Pe(rL.key).entityId,PF.has(Au)||cF.push(rL.key));return cF.length?g.l(p,ot7(c,cF),0):p.GF(0)})};g.D(ug$,bj);ug$.prototype.N=function(c){return jD(c)?v2z(this,c):mY(c)?Pdb(this,c):nI(c)?MJs(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};
var ZD=[10];g.D(GVs,bj);GVs.prototype.N=function(c){return jD(c)?mpL(this,c):mY(c)?n2k(this,c):nI(c)?hgk(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};
var z5=[10];g.D(Nik,bj);Nik.prototype.N=function(c){return jD(c)?J9X(this,c):mY(c)?Y$z(this,c):nI(c)?Lgk(this,c):Promise.reject(Error("Unsupported action type: "+c.actionType))};
var y97=[10];g.D(Qc,dD);Qc.prototype.yS=function(c){var I=dD.prototype.yS.call(this,c);I.musicTrack=new Nik(c,this.C);I.musicPlaylist=new GVs(c,this.C);I.musicAlbumRelease=new ug$(c,this.C);return I};
Qc.prototype.refreshAllStaleEntities=function(c,I){var O=this,r,u,X;return g.E(function(v){if(v.C==1)return g.l(v,Upb(O,c,I),2);if(v.C!=3)return u=r=v.N,X=u.concat,g.l(v,dD.prototype.refreshAllStaleEntities.call(O,c,I),3);r=X.call(u,v.N);return v.return(r)})};g.D(CdL,g.tI);g.P=CdL.prototype;g.P.create=function(){var c=this;g.B(this,this.events);g.wp(this.uq)?this.C=new Iju(this.uq,this.player):g.kC(this.uq)&&(this.C=new Qc(this.uq,this.player));this.events.Z(this.player,"onPlaybackStartExternal",function(){c.yu()});
this.events.Z(this.player,"videodatachange",function(){c.yu()});
this.uq.B("html5_offline_playback_position_sync")&&this.events.Z(this.player,"presentingplayerstatechange",this.sY)};
g.P.N5=function(){return!1};
g.P.D$=function(c,I,O,r){var u=this;return g.E(function(X){return u.C?X.return(RP(u.C,c,I,O,r)):X.return(Promise.reject())})};
g.P.deleteAll=function(){return this.C.deleteAll()};
g.P.Oi=function(c){return this.C.Oi(c)};
g.P.refreshAllStaleEntities=function(c){return this.C.refreshAllStaleEntities(c)};
g.P.setUpPositionSyncInterval=function(c){this.C.setUpPositionSyncInterval(c)};
g.P.H1=function(c){this.C.H1(c)};
g.P.eO=function(c){return this.C.eO(c)};
g.P.yu=function(){var c=this,I;return g.E(function(O){I=c.player.getVideoData();return g.RM(I)?tJk(I)&&c.N!==I.clientPlaybackNonce?g.l(O,Hok(c,I),0):O.GF(0):O.return()})};
g.P.sY=function(c){var I=this,O,r,u,X,v,M,G;return g.E(function(m){if(m.C==1)return O=I.player.getVideoData(),r=O.KV,g.Ae(c,2)||g.Ae(c,512)?g.l(m,cy(),2):m.return();if(m.C!=3){u=m.N;if(!u)return uj("PES is undefined"),m.return();X=O.videoId;return g.l(m,zK(u,g.MA(X,"mainVideoEntity"),"mainVideoEntity"),3)}v=m.N;if(!v)return m.return();M=Math.floor(r).toString();G={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:M}};return g.l(m,I.D$([X],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
G),0)})};
g.P.isOrchestrationLeader=function(){return this.C.isOrchestrationLeader()};
g.P.updateDownloadState=function(c,I){var O,r,u,X;return g.E(function(v){if(v.C==1)return g.l(v,cy(),2);O=v.N;if(!O)return uj("PES is undefined"),v.return();r=g.Pe(c);u=r.entityType;X=r.entityId;return g.l(v,hn(X,u,O,I,!0),0)})};g.C1("offline",CdL);})(_yt_player);
